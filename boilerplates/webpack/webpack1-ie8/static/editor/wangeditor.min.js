/* 基于 wangeditor@2.1.23/wangeditor.js#全局配置 有较大改动 */
(function(a){if(typeof window.define==="function"){if(window.define.amd){window.define("wangEditor",["jquery"],a)}else if(window.define.cmd){window.define(function(e,t,n){return a})}else{a(window.jQuery)}}else if(typeof module==="object"&&typeof module.exports==="object"){require("./wangeditor.min.css");module.exports=a(require("jquery"))}else{a(window.jQuery)}})(function(n){if(!n||!n.fn||!n.fn.jquery){alert("在引用wangEditor.js之前，先引用jQuery，否则无法使用 wangEditor");return}var e=function(e){var t=window.wangEditor;if(t){e(t,n)}};(function(e,a){if(e.wangEditor){alert("一个页面不能重复引用 wangEditor.js 或 wangEditor.min.js ！！！");return}var t=function(e){if(typeof e==="string"){e="#"+e}var t=a(e);if(t.length!==1){return}var n=t[0].nodeName;if(n!=="TEXTAREA"&&n!=="DIV"){return}this.valueNodeName=n.toLowerCase();this.$valueContainer=t;this.$prev=t.prev();this.$parent=t.parent();this.init()};t.fn=t.prototype;t.$body=a("body");t.$document=a(document);t.$window=a(e);t.userAgent=navigator.userAgent;t.getComputedStyle=e.getComputedStyle;t.w3cRange=typeof document.createRange==="function";t.hostname=location.hostname.toLowerCase();t.websiteHost="wangeditor.github.io|wangeditor.com|wangeditor.coding.me";t.isOnWebsite=t.websiteHost.indexOf(t.hostname)>=0;t.docsite="https://kancloud.cn/wangfupeng/wangeditor2/113961";e.wangEditor=t;t.plugin=function(e){if(!t._plugins){t._plugins=[]}if(typeof e==="function"){t._plugins.push(e)}}})(window,n);e(function(e,t){e.fn.init=function(){this.initDefaultConfig();this.addEditorContainer();this.addTxt();this.addMenuContainer();this.menus={};this.commandHooks()}});e(function(e,t){e.fn.ready=function(e){if(!this.readyFns){this.readyFns=[]}this.readyFns.push(e)};e.fn.readyHeadler=function(){var e=this.readyFns;while(e.length){e.shift().call(this)}};e.fn.updateValue=function(){var e=this;var t=e.$valueContainer;var n=e.txt.$txt;if(t===n){return}var a=n.html();t.val(a)};e.fn.getInitValue=function(){var e=this;var t=e.$valueContainer;var n="";var a=e.valueNodeName;if(a==="div"){n=t.html()}else if(a==="textarea"){n=t.val()}return n};e.fn.updateMenuStyle=function(){var e=this.menus;t.each(e,function(e,t){t.updateSelected()})};e.fn.enableMenusExcept=function(n){if(this._disabled){return}n=n||[];if(typeof n==="string"){n=[n]}t.each(this.menus,function(e,t){if(n.indexOf(e)>=0){return}t.disabled(false)})};e.fn.disableMenusExcept=function(n){if(this._disabled){return}n=n||[];if(typeof n==="string"){n=[n]}t.each(this.menus,function(e,t){if(n.indexOf(e)>=0){return}t.disabled(true)})};e.fn.hideDropPanelAndModal=function(){var e=this.menus;t.each(e,function(e,t){var n=t.dropPanel||t.dropList||t.modal;if(n&&n.hide){n.hide()}})}});e(function(a,o){var e=!a.w3cRange;function t(){}a.fn.currentRange=function(e){if(e){this._rangeData=e}else{return this._rangeData}};a.fn.collapseRange=function(e,t){t=t||"end";t=t==="start"?true:false;e=e||this.currentRange();if(e){e.collapse(t);this.currentRange(e)}};a.fn.getRangeText=e?t:function(e){e=e||this.currentRange();if(!e){return}return e.toString()};a.fn.getRangeElem=e?t:function(e){e=e||this.currentRange();var t=e.commonAncestorContainer;if(t.nodeType===1){return t}else{return t.parentNode}};a.fn.isRangeEmpty=e?t:function(e){e=e||this.currentRange();if(e&&e.startContainer){if(e.startContainer===e.endContainer){if(e.startOffset===e.endOffset){return true}}}return false};a.fn.saveSelection=e?t:function(e){var t=this,n,a,i=t.txt.$txt.get(0);if(e){n=e.commonAncestorContainer}else{a=document.getSelection();if(a.getRangeAt&&a.rangeCount){e=document.getSelection().getRangeAt(0);n=e.commonAncestorContainer}}if(n&&(o.contains(i,n)||i===n)){t.currentRange(e)}};a.fn.restoreSelection=e?t:function(e){var t;e=e||this.currentRange();if(!e){return}try{t=document.getSelection();t.removeAllRanges();t.addRange(e)}catch(n){a.error("执行 editor.restoreSelection 时，IE可能会有异常，不影响使用")}};a.fn.restoreSelectionByElem=e?t:function(e,t){if(!e){return}t=t||"end";this.setRangeByElem(e);if(t==="start"){this.collapseRange(this.currentRange(),"start")}if(t==="end"){this.collapseRange(this.currentRange(),"end")}this.restoreSelection()};a.fn.initSelection=e?t:function(){var e=this;if(e.currentRange()){return}var t;var n=e.txt.$txt;var a=n.children().first();if(a.length){e.restoreSelectionByElem(a.get(0))}};a.fn.setRangeByElem=e?t:function(e){var t=this;var n=t.txt.$txt.get(0);if(!e||!o.contains(n,e)){return}var a=e.firstChild;while(a){if(a.nodeType===3){break}a=a.firstChild}var i=e.lastChild;while(i){if(i.nodeType===3){break}i=i.lastChild}var r=document.createRange();if(a&&i){r.setStart(a,0);r.setEnd(i,i.textContent.length)}else{r.setStart(e,0);r.setEnd(e,0)}t.saveSelection(r)}});e(function(e,r){if(e.w3cRange){return}e.fn.getRangeText=function(e){e=e||this.currentRange();if(!e){return}return e.text};e.fn.getRangeElem=function(e){e=e||this.currentRange();if(!e){return}var t=e.parentElement();if(t.nodeType===1){return t}else{return t.parentNode}};e.fn.isRangeEmpty=function(e){e=e||this.currentRange();if(e&&e.text){return false}return true};e.fn.saveSelection=function(e){var t=this,n,a,i=t.txt.$txt.get(0);if(e){n=e.parentElement()}else{e=document.selection.createRange();if(e.parentElement===void 0){n=null}else{n=e.parentElement()}}if(n&&(r.contains(i,n)||i===n)){t.currentRange(e)}};e.fn.restoreSelection=function(e){var t=this,n,a;e=e||t.currentRange();if(!e){return}a=document.selection.createRange();try{a.setEndPoint("EndToEnd",e)}catch(i){}if(e.text.length===0){try{a.collapse(false)}catch(i){}}else{a.setEndPoint("StartToStart",e)}a.select()}});e(function(e,r){e.fn.commandHooks=function(){var i=this;var e={};e.insertHtml=function(e){var t=r(e);var n=i.getRangeElem();var a;a=i.getLegalTags(n);if(!a){return}r(a).after(t)};i.commandHooks=e}});e(function(e,t){e.fn.command=function(e,t,n,a){var i=this;var r;function o(){if(!t){return}if(i.queryCommandSupported(t)){document.execCommand(t,false,n)}else{r=i.commandHooks;if(t in r){r[t](n)}}}this.customCommand(e,o,a)};e.fn.commandForElem=function(e,t,n,a,i){var r;var o;if(typeof e==="string"){r=e}else{r=e.selector;o=e.check}var l=this.getRangeElem();l=this.getSelfOrParentByName(l,r,o);if(l){this.setRangeByElem(l)}this.command(t,n,a,i)};e.fn.customCommand=function(e,t,n){var a=this;var i=a.currentRange();if(!i){e&&e.preventDefault();return}a.undoRecord();this.restoreSelection(i);t.call(a);this.saveSelection();this.restoreSelection();if(n&&typeof n==="function"){n.call(a)}a.txt.insertEmptyP();a.txt.wrapImgAndText();a.updateValue();a.updateMenuStyle();function r(){a.hideDropPanelAndModal()}setTimeout(r,200);if(e){e.preventDefault()}};e.fn.queryCommandValue=function(e){var t="";try{t=document.queryCommandValue(e)}catch(n){}return t};e.fn.queryCommandState=function(e){var t=false;try{t=document.queryCommandState(e)}catch(n){}return t};e.fn.queryCommandSupported=function(e){var t=false;try{t=document.queryCommandSupported(e)}catch(n){}return t}});e(function(n,i){var r;function o(e){var t=this;var n=i(e);var a=false;n.each(function(){if(this===t){a=true;return false}});return a}n.fn.getLegalTags=function(e){var t=this.config.legalTags;if(!t){n.error("配置项中缺少 legalTags 的配置");return}return this.getSelfOrParentByName(e,t)};n.fn.getSelfOrParentByName=function(e,t,n){if(!e||!t){return}if(!r){r=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector}if(!r){r=o}var a=this.txt.$txt.get(0);while(e&&a!==e&&i.contains(a,e)){if(r.call(e,t)){if(!n){return e}if(n(e)){return e}}e=e.parentNode}return}});e(function(e,t){var o=20;function l(e){if(e._redoList==null){e._redoList=[]}return e._redoList}function c(e){if(e._undoList==null){e._undoList=[]}return e._undoList}function i(e,t,n){var a=t.val;var i=e.txt.$txt.html();if(a==null){return}if(a===i){if(n==="redo"){e.redo();return}else if(n==="undo"){e.undo();return}else{return}}e.txt.$txt.html(a);e.updateValue();if(e.onchange&&typeof e.onchange==="function"){e.onchange.call(e)}}e.fn.undoRecord=function(){var e=this;var t=e.txt.$txt;var n=t.html();var a=c(e);var i=l(e);var r=a.length?a[0]:"";if(n===r.val){return}if(i.length){i=[]}a.unshift({range:e.currentRange(),val:n});if(a.length>o){a.pop()}};e.fn.undo=function(){var e=this;var t=c(e);var n=l(e);if(!t.length){return}var a=t.shift();n.unshift(a);i(this,a,"undo")};e.fn.redo=function(){var e=this;var t=c(e);var n=l(e);if(!n.length){return}var a=n.shift();t.unshift(a);i(this,a,"redo")}});e(function(t,a){t.fn.create=function(){var n=this;if(!t.$body||t.$body.length===0){t.$body=a("body");t.$document=a(document);t.$window=a(window)}n.addMenus();n.renderMenus();n.renderMenuContainer();n.renderTxt();n.renderEditorContainer();n.eventMenus();n.eventMenuContainer();n.eventTxt();n.readyHeadler();n.initSelection();n.$txt=n.txt.$txt;var e=t._plugins;if(e&&e.length){a.each(e,function(e,t){t.call(n)})}};t.fn.disable=function(){this.txt.$txt.removeAttr("contenteditable");this.disableMenusExcept();this._disabled=true};t.fn.enable=function(){this._disabled=false;this.txt.$txt.attr("contenteditable","true");this.enableMenusExcept()};t.fn.destroy=function(){var e=this;var t=e.$valueContainer;var n=e.$editorContainer;var a=e.valueNodeName;if(a==="div"){t.removeAttr("contenteditable");n.after(t);n.hide()}else{t.show();n.hide()}};t.fn.undestroy=function(){var e=this;var t=e.$valueContainer;var n=e.$editorContainer;var a=e.menuContainer.$menuContainer;var i=e.valueNodeName;if(i==="div"){t.attr("contenteditable","true");a.after(t);n.show()}else{t.hide();n.show()}};t.fn.clear=function(){var e=this;var t=e.txt.$txt;t.html("<p><br></p>");e.restoreSelectionByElem(t.find("p").get(0))}});e(function(e,t){var n=function(e){this.editor=e;this.init()};n.fn=n.prototype;e.MenuContainer=n});e(function(e,n){var t=e.MenuContainer;t.fn.init=function(){var e=this;var t=n('<div class="wangEditor-menu-container clearfix"></div>');e.$menuContainer=t;e.changeShadow()};t.fn.changeShadow=function(){var e=this.$menuContainer;var t=this.editor;var n=t.txt.$txt;n.on("scroll",function(){if(n.scrollTop()>10){e.addClass("wangEditor-menu-shadow")}else{e.removeClass("wangEditor-menu-shadow")}})}});e(function(e,r){var t=e.MenuContainer;t.fn.render=function(){var e=this.$menuContainer;var t=this.editor.$editorContainer;t.append(e)};t.fn.height=function(){var e=this.$menuContainer;return e.height()};t.fn.appendMenu=function(e,t){this._addGroup(e);return this._addOneMenu(t)};t.fn._addGroup=function(e){var t=this.$menuContainer;var n;if(!this.$currentGroup||this.currentGroupIdx!==e){n=r('<div class="menu-group clearfix"></div>');t.append(n);this.$currentGroup=n;this.currentGroupIdx=e}};t.fn._addOneMenu=function(e){var t=e.$domNormal;var n=e.$domSelected;var a=this.$currentGroup;var i=r('<div class="menu-item clearfix"></div>');n.hide();i.append(t).append(n);a.append(i);return i}});e(function(e,t){var n=function(e){this.editor=e.editor;this.id=e.id;this.title=e.title;this.$domNormal=e.$domNormal;this.$domSelected=e.$domSelected||e.$domNormal;this.commandName=e.commandName;this.commandValue=e.commandValue;this.commandNameSelected=e.commandNameSelected||e.commandName;this.commandValueSelected=e.commandValueSelected||e.commandValue};n.fn=n.prototype;e.Menu=n});e(function(i,r){var e=i.Menu;e.fn.initUI=function(){var e=this.editor;var t=e.UI.menus;var n=this.id;var a=t[n];if(this.$domNormal&&this.$domSelected){return}if(a==null){i.warn('editor.UI配置中，没有菜单 "'+n+'" 的UI配置，只能取默认值');a=t["default"]}this.$domNormal=r(a.normal);if(/^\./.test(a.selected)){this.$domSelected=this.$domNormal.clone().addClass(a.selected.slice(1))}else{this.$domSelected=r(a.selected)}}});e(function(s,u){var e=s.Menu;e.fn.render=function(e){this.initUI();var t=this.editor;var n=t.menuContainer;var a=n.appendMenu(e,this);var i=this.onRender;this._renderTip(a);if(i&&typeof i==="function"){i.call(this)}};e.fn._renderTip=function(e){var i=this;var t=i.editor;var n=i.title;var r=u('<div class="menu-tip"></div>');var o;if(!i.tipWidth){o=u('<p style="opacity:0; filter:Alpha(opacity=0); position:absolute;top:-10000px;">'+n+"</p>");s.$body.append(o);t.ready(function(){var e=this;var t=o.outerWidth()+5;var n=r.outerWidth();var a=parseFloat(r.css("margin-left"),10);o.remove();o=null;r.css({width:t,"margin-left":a+(n-t)/2});i.tipWidth=t})}r.append(n);e.append(r);function a(){r.show()}function l(){r.hide()}var c;e.find("a").on("mouseenter",function(e){if(!i.active()&&!i.disabled()){c=setTimeout(a,200)}}).on("mouseleave",function(e){c&&clearTimeout(c);l()}).on("click",l)};e.fn.bindEvent=function(){var o=this;var e=o.$domNormal;var t=o.$domSelected;var n=o.clickEvent;if(!n){n=function(e){var t=o.dropPanel||o.dropList||o.modal;if(t&&t.show){if(t.isShowing){t.hide()}else{t.show()}return}var n=o.editor;var a;var i;var r=o.selected;if(r){a=o.commandNameSelected;i=o.commandValueSelected}else{a=o.commandName;i=o.commandValue}if(a){n.command(e,a,i)}else{s.warn('菜单 "'+o.id+'" 未定义click事件');e.preventDefault()}}}var a=o.clickEventSelected||n;e.click(function(e){if(!o.disabled()){n.call(o,e);o.updateSelected()}e.preventDefault()});t.click(function(e){if(!o.disabled()){a.call(o,e);o.updateSelected()}e.preventDefault()})};e.fn.updateSelected=function(){var e=this;var t=e.editor;var n=e.updateSelectedEvent;if(!n){n=function(){var e=this;var t=e.editor;var n=e.commandName;var a=e.commandValue;if(a){if(t.queryCommandValue(n).toLowerCase()===a.toLowerCase()){return true}}else if(t.queryCommandState(n)){return true}return false}}var a=n.call(e);a=!!a;e.changeSelectedState(a)};e.fn.changeSelectedState=function(e){var t=this;var n=t.selected;if(e!=null&&typeof e==="boolean"){if(n===e){return}t.selected=e;if(e){t.$domNormal.hide();t.$domSelected.show()}else{t.$domNormal.show();t.$domSelected.hide()}}};e.fn.active=function(e){if(e==null){return this._activeState}this._activeState=e};e.fn.activeStyle=function(e){var t=this.selected;var n=this.$domNormal;var a=this.$domSelected;if(e){n.addClass("active");a.addClass("active")}else{n.removeClass("active");a.removeClass("active")}this.active(e)};e.fn.disabled=function(e){if(e==null){return!!this._disabled}if(this._disabled===e){return}var t=this.$domNormal;var n=this.$domSelected;if(e){t.addClass("disable");n.addClass("disable")}else{t.removeClass("disable");n.removeClass("disable")}this._disabled=e}});e(function(e,t){var n=function(e,t,n){this.editor=e;this.menu=t;this.data=n.data;this.tpl=n.tpl;this.selectorForELemCommand=n.selectorForELemCommand;this.beforeEvent=n.beforeEvent;this.afterEvent=n.afterEvent;this.init()};n.fn=n.prototype;e.DropList=n});e(function(e,c){var t=e.DropList;t.fn.init=function(){var e=this;e.initDOM();e.bindEvent();e.initHideEvent()};t.fn.initDOM=function(){var e=this;var t=e.data;var n=e.tpl||"<span>{#title}</span>";var a=c('<div class="wangEditor-drop-list clearfix"></div>');var i;var r;c.each(t,function(e,t){i=n.replace(/{#commandValue}/gi,e).replace(/{#title}/gi,t);r=c('<a href="#" commandValue="'+e+'"></a>');r.append(i);a.append(r)});e.$list=a};t.fn.bindEvent=function(){var e=this;var n=e.editor;var a=e.menu;var i=a.commandName;var r=e.selectorForELemCommand;var t=e.$list;var o=e.beforeEvent;var l=e.afterEvent;t.on("click","a[commandValue]",function(e){if(o&&typeof o==="function"){o.call(e)}var t=c(e.currentTarget).attr("commandValue");if(a.selected&&n.isRangeEmpty()&&r){n.commandForElem(r,e,i,t)}else{n.command(e,i,t)}if(l&&typeof l==="function"){l.call(e)}})};t.fn.initHideEvent=function(){var i=this;var r=i.$list.get(0);e.$body.on("click",function(e){if(!i.isShowing){return}var t=e.target;var n=i.menu;var a;if(n.selected){a=n.$domSelected.get(0)}else{a=n.$domNormal.get(0)}if(a===t||c.contains(a,t)){return}if(r===t||c.contains(r,t)){return}i.hide()});e.$window.scroll(function(){i.hide()});e.$window.on("resize",function(){i.hide()})}});e(function(e,t){var n=e.DropList;n.fn._render=function(){var e=this;var t=e.editor;var n=e.$list;t.$editorContainer.append(n);e.rendered=true};n.fn._position=function(){var e=this;var t=e.$list;var n=e.editor;var a=e.menu;var i=n.menuContainer.$menuContainer;var r=a.selected?a.$domSelected:a.$domNormal;var o=r.offsetParent().position();var l=o.top;var c=o.left;var s=r.offsetParent().height();var u=r.offsetParent().width();var f=t.outerWidth();var d=n.txt.$txt.outerWidth();var v=l+s;var m=c+u/2;var p=0-u/2;var h=m+f-d;if(h>-10){p=p-h-10}t.css({top:v,left:m,"margin-left":p});if(n._isMenufixed){v=v+(i.offset().top+i.outerHeight()-t.offset().top);t.css({top:v})}};n.fn.show=function(){var e=this;var t=e.menu;if(!e.rendered){e._render()}if(e.isShowing){return}var n=e.$list;n.show();e._position();e.isShowing=true;t.activeStyle(true)};n.fn.hide=function(){var e=this;var t=e.menu;if(!e.isShowing){return}var n=e.$list;n.hide();e.isShowing=false;t.activeStyle(false)}});e(function(e,t){var n=function(e,t,n){this.editor=e;this.menu=t;this.$content=n.$content;this.width=n.width||200;this.height=n.height;this.onRender=n.onRender;this.init()};n.fn=n.prototype;e.DropPanel=n});e(function(e,o){var t=e.DropPanel;t.fn.init=function(){var e=this;e.initDOM();e.initHideEvent()};t.fn.initDOM=function(){var e=this;var t=e.$content;var n=e.width;var a=e.height;var i=o('<div class="wangEditor-drop-panel clearfix"></div>');var r=o('<div class="tip-triangle"></div>');i.css({width:n,height:a?a:"auto"});i.append(r);i.append(t);e.$panel=i;e.$triangle=r};t.fn.initHideEvent=function(){var i=this;var r=i.$panel.get(0);e.$body.on("click",function(e){if(!i.isShowing){return}var t=e.target;var n=i.menu;var a;if(n.selected){a=n.$domSelected.get(0)}else{a=n.$domNormal.get(0)}if(a===t||o.contains(a,t)){return}if(r===t||o.contains(r,t)){return}i.hide()});e.$window.scroll(function(e){i.hide()});e.$window.on("resize",function(){i.hide()})}});e(function(a,n){var e=a.DropPanel;e.fn._render=function(){var e=this;var t=e.onRender;var n=e.editor;var a=e.$panel;n.$editorContainer.append(a);t&&t.call(e);e.rendered=true};e.fn._position=function(){var e=this;var t=e.$panel;var n=e.$triangle;var a=e.editor;var i=a.menuContainer.$menuContainer;var r=e.menu;var o=r.selected?r.$domSelected:r.$domNormal;var l=o.offsetParent().position();var c=l.top;var s=l.left;var u=o.offsetParent().height();var f=o.offsetParent().width();var d=t.outerWidth();var v=a.txt.$txt.outerWidth();var m=c+u;var p=s+f/2;var h=0-d/2;var g=h;if(0-h>p-10){h=0-(p-10)}var w=p+d+h-v;if(w>-10){h=h-w-10}t.css({top:m,left:p,"margin-left":h});if(a._isMenufixed){m=m+(i.offset().top+i.outerHeight()-t.offset().top);t.css({top:m})}n.css({"margin-left":g-h-5})};e.fn.focusFirstInput=function(){var e=this;var t=e.$panel;t.find("input[type=text],textarea").each(function(){var e=n(this);if(e.attr("disabled")==null){e.focus();return false}})};e.fn.show=function(){var e=this;var t=e.menu;if(!e.rendered){e._render()}if(e.isShowing){return}var n=e.$panel;n.show();e._position();e.isShowing=true;t.activeStyle(true);if(a.w3cRange){e.focusFirstInput()}else{a.placeholderForIE8(n)}};e.fn.hide=function(){var e=this;var t=e.menu;if(!e.isShowing){return}var n=e.$panel;n.hide();e.isShowing=false;t.activeStyle(false)}});e(function(e,t){var n=function(e,t,n){this.editor=e;this.menu=t;this.$content=n.$content;this.init()};n.fn=n.prototype;e.Modal=n});e(function(t,o){var e=t.Modal;e.fn.init=function(){var e=this;e.initDom();e.initHideEvent()};e.fn.initDom=function(){var e=this;var t=e.$content;var n=o('<div class="wangEditor-modal"></div>');var a=o('<div class="wangEditor-modal-close"><i class="wangeditor-menu-img-cancel-circle"></i></div>');n.append(a);n.append(t);e.$modal=n;e.$close=a};e.fn.initHideEvent=function(){var i=this;var e=i.$close;var r=i.$modal.get(0);e.click(function(){i.hide()});t.$body.on("click",function(e){if(!i.isShowing){return}var t=e.target;var n=i.menu;var a;if(n){if(n.selected){a=n.$domSelected.get(0)}else{a=n.$domNormal.get(0)}if(a===t||o.contains(a,t)){return}}if(r===t||o.contains(r,t)){return}i.hide()})}});e(function(c,e){var t=c.Modal;t.fn._render=function(){var e=this;var t=e.editor;var n=e.$modal;n.css("z-index",t.config.zindex+10+"");c.$body.append(n);e.rendered=true};t.fn._position=function(){var e=this;var t=e.$modal;var n=t.offset().top;var a=t.outerWidth();var i=t.outerHeight();var r=0-a/2;var o=0-i/2;var l=c.$window.scrollTop();if(i/2>n){o=0-n}t.css({"margin-left":r+"px","margin-top":o+l+"px"})};t.fn.show=function(){var e=this;var t=e.menu;if(!e.rendered){e._render()}if(e.isShowing){return}e.isShowing=true;var n=e.$modal;n.show();e._position();t&&t.activeStyle(true)};t.fn.hide=function(){var e=this;var t=e.menu;if(!e.isShowing){return}e.isShowing=false;var n=e.$modal;n.hide();t&&t.activeStyle(false)}});e(function(e,t){var n=function(e){this.editor=e;this.init()};n.fn=n.prototype;e.Txt=n});e(function(c,d){var e=c.Txt;e.fn.init=function(){var e=this;var t=e.editor;var n=t.$valueContainer;var a=t.getInitValue();var i;if(n.get(0).nodeName==="DIV"){i=n;i.addClass("wangEditor-txt");i.attr("contentEditable","true")}else{i=d('<div class="wangEditor-txt" contentEditable="true">'+a+"</div>")}t.ready(function(){e.insertEmptyP()});e.$txt=i;e.contentEmptyHandle();e.bindEnterForDiv();e.bindEnterForText();e.bindTabEvent();e.bindPasteFilter();e.bindFormatText();e.bindHtml()};e.fn.contentEmptyHandle=function(){var e=this;var n=e.editor;var a=e.$txt;var i;a.on("keydown",function(e){if(e.keyCode!==8){return}var t=d.trim(a.html().toLowerCase());if(t==="<p><br></p>"){e.preventDefault();return}});a.on("keyup",function(e){if(e.keyCode!==8){return}var t=d.trim(a.html().toLowerCase());if(!t||t==="<br>"){i=d("<p><br/></p>");a.html("");a.append(i);n.restoreSelectionByElem(i.get(0))}})};e.fn.bindEnterForDiv=function(){var e=c.config.legalTags;var t=this;var r=t.editor;var n=t.$txt;var o;function l(){if(!o){return}var e=d("<p>"+o.html()+"</p>");o.after(e);o.remove()}n.on("keydown keyup",function(e){if(e.keyCode!==13){return}var t=r.getRangeElem();var n=r.getLegalTags(t);var a;var i;if(!n){n=r.getSelfOrParentByName(t,"div");if(!n){return}a=d(n);if(e.type==="keydown"){o=a;setTimeout(l,0)}if(e.type==="keyup"){i=d("<p>"+a.html()+"</p>");a.after(i);a.remove();r.restoreSelectionByElem(i.get(0),"start")}}})};e.fn.bindEnterForText=function(){var t=this;var e=t.$txt;var n;e.on("keyup",function(e){if(e.keyCode!==13){return}if(!n){n=function(){t.wrapImgAndText()}}setTimeout(n)})};e.fn.bindTabEvent=function(){var e=this;var t=e.editor;var n=e.$txt;n.on("keydown",function(e){if(e.keyCode!==9){return}if(t.queryCommandSupported("insertHtml")){t.command(e,"insertHtml","&nbsp;&nbsp;&nbsp;&nbsp;")}})};e.fn.bindPasteFilter=function(){var l=this;var c=l.editor;var s="";var e=l.$txt;var t=c.config.legalTags;var r=t.split(",");e.on("paste",function(e){if(!c.config.pasteFilter){return}var t=c.getRangeElem().nodeName;if(t==="TD"||t==="TH"){return}s="";var n,a,i;var r=e.clipboardData||e.originalEvent.clipboardData;var o=window.clipboardData;if(c.config.pasteText){if(r&&r.getData){n=r.getData("text/plain")}else if(o&&o.getData){n=o.getData("text")}else{return}if(n){s="<p>"+n+"</p>"}}else{if(r&&r.getData){n=r.getData("text/html");i=n.split("</html>");if(i.length===2){n=i[0]}if(n){a=d("<div>"+n+"</div>");u(a.get(0))}else{n=r.getData("text/plain");if(n){n=n.replace(/[ ]/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"</p><p>");s="<p>"+n+"</p>";s=s.replace(/<p>(https?:\/\/.*?)<\/p>/gi,function(e,t){return'<p><a href="'+t+'" target="_blank">'+t+"</p>"})}}}else if(o&&o.getData){s=o.getData("text");if(!s){return}s="<p>"+s+"</p>";s=s.replace(new RegExp("\n","g"),"</p><p>")}else{return}}if(s){c.command(e,"insertHtml",s);l.clearEmptyOrNestP()}});function u(e){if(!e||!e.nodeType||!e.nodeName){return}var t;var n=e.nodeName.toLowerCase();var a=e.nodeType;var i;if(a!==3&&a!==1){return}t=d(e);if(n==="div"){i=[];d.each(e.childNodes,function(e,t){i.push(t)});d.each(i,function(){u(this)});return}if(r.indexOf(n)>=0){s+=o(e)}else if(a===3){s+="<p>"+e.textContent+"</p>"}else if(n==="br"){s+="<br/>"}else{if(["meta","style","script","object","form","iframe","hr"].indexOf(n)>=0){return}t=d(f(e));s+=d("<div>").append(t.clone()).html()}}function o(e){var t=e.nodeName.toLowerCase();var n;var a="";var i="";if(["blockquote"].indexOf(t)>=0){n=d(e);return"<"+t+">"+n.text()+"</"+t+">"}else if(["p","h1","h2","h3","h4","h5"].indexOf(t)>=0){e=f(e);n=d(e);a=n.html();a=a.replace(/<.*?>/gi,function(e){if(e==="</a>"||e.indexOf("<a ")===0||e.indexOf("<img ")===0){return e}else{return""}});return"<"+t+">"+a+"</"+t+">"}else if(["ul","ol"].indexOf(t)>=0){n=d(e);n.children().each(function(){var e=d(f(this));var t=e.html();t=t.replace(/<.*?>/gi,function(e){if(e==="</a>"||e.indexOf("<a ")===0||e.indexOf("<img ")===0){return e}else{return""}});i+="<li>"+t+"</li>"});return"<"+t+">"+i+"</"+t+">"}else{n=d(f(e));return d("<div>").append(n).html()}}function f(n){var e=n.attributes||[];var a=[];var i=["href","target","src","alt","rowspan","colspan"];d.each(e,function(e,t){if(t&&t.nodeType===2){a.push(t.nodeName)}});d.each(a,function(e,t){if(i.indexOf(t)<0){n.removeAttribute(t)}});var t=n.childNodes;if(t.length){d.each(t,function(e,t){f(t)})}return n}};e.fn.bindFormatText=function(){var e=this;var t=e.editor;var a=e.$txt;var n=c.config.legalTags;var i=n.split(",");var r=i.length;var o=[];d.each(i,function(e,t){var n=">\\s*<("+t+")>";o.push(new RegExp(n,"ig"))});o.push(new RegExp(">\\s*<(li)>","ig"));o.push(new RegExp(">\\s*<(tr)>","ig"));o.push(new RegExp(">\\s*<(code)>","ig"));a.formatText=function(){var e=d("<div>");var n=a.html();n=n.replace(/\s*</gi,"<");d.each(o,function(e,t){if(!t.test(n)){return}n=n.replace(t,function(e,t){return">\n<"+t+">"})});e.html(n);return e.text()}};e.fn.bindHtml=function(){var e=this;var t=e.editor;var n=e.$txt;var a=t.$valueContainer;var i=t.valueNodeName;n.html=function(e){var t;if(i==="div"){t=d.fn.html.call(n,e)}if(e===void 0){t=d.fn.html.call(n);t=t.replace(/(href|src)\=\"(.*)\"/gim,function(e,t,n){return t+'="'+n.replace("&amp;","&")+'"'})}else{t=d.fn.html.call(n,e);a.val(e)}if(e===void 0){return t}else{n.change()}}}});e(function(l,c){var e=l.Txt;var s="propertychange change click keyup input paste";e.fn.render=function(){var e=this.$txt;var t=this.editor.$editorContainer;t.append(e)};e.fn.initHeight=function(){var e=this.editor;var t=this.$txt;var n=e.$valueContainer.height();var a=e.menuContainer.height();var i=n-a;i=i<50?50:i;t.height(i);e.valueContainerHeight=n;this.initMaxHeight(i,a)};e.fn.initMaxHeight=function(e,t){var n=this.editor;var a=n.menuContainer.$menuContainer;var i=this.$txt;var r=c("<div>");if(window.getComputedStyle&&"max-height"in window.getComputedStyle(i.get(0))){var o=parseInt(n.$valueContainer.css("max-height"));if(isNaN(o)){return}if(n.menus.fullscreen){l.warn("max-height和『全屏』菜单一起使用时，会有一些问题尚未解决，请暂时不要两个同时使用");return}n.useMaxHeight=true;r.css({"max-height":o-t+"px","overflow-y":"auto"});i.css({height:"auto","overflow-y":"visible","min-height":e+"px"});r.on("scroll",function(){if(i.parent().scrollTop()>10){a.addClass("wangEditor-menu-shadow")}else{a.removeClass("wangEditor-menu-shadow")}});i.wrap(r)}};e.fn.saveSelectionEvent=function(){var e=this.$txt;var t=this.editor;var n;var a=Date.now();function i(){t.saveSelection()}function r(){if(Date.now()-a<100){return}a=Date.now();i()}function o(){if(n){clearTimeout(n)}n=setTimeout(i,300)}e.on(s+" focus blur",function(e){r();o()});e.on("mousedown",function(){e.on("mouseleave.saveSelection",function(e){r();o();t.updateMenuStyle()})}).on("mouseup",function(){e.off("mouseleave.saveSelection")})};e.fn.updateValueEvent=function(){var t=this.$txt;var n=this.editor;var a,i;function r(){var e=t.html();if(i===e){return}if(n.onchange&&typeof n.onchange==="function"){n.onchange.call(n)}n.updateValue();i=e}t.on(s,function(e){if(i==null){i=t.html()}if(a){clearTimeout(a)}a=setTimeout(r,100)})};e.fn.updateMenuStyleEvent=function(){var e=this.$txt;var t=this.editor;e.on(s,function(e){t.updateMenuStyle()})};e.fn.insertEmptyP=function(){var e=this.$txt;var t=e.children();if(t.length===0){e.append(c("<p><br></p>"));return}if(c.trim(t.last().html()).toLowerCase()!=="<br>"){e.append(c("<p><br></p>"))}};e.fn.wrapImgAndText=function(){var e=this.$txt;var t=e.children("img");var n=e[0];var a=n.childNodes;var i=a.length;var r,o,l;t.length&&t.each(function(){c(this).wrap("<p>")});for(r=0;r<i;r++){o=a[r];if(o.nodeType===3&&o.textContent&&c.trim(o.textContent)){c(o).wrap("<p>")}}};e.fn.clearEmptyOrNestP=function(){var e=this.$txt;var t=e.find("p");t.each(function(){var e=c(this);var t=e.children();var n=t.length;var a;var i=c.trim(e.html());if(!i){e.remove();return}if(n===1){a=t.first();if(a.get(0)&&a.get(0).nodeName==="P"){e.html(a.html())}}})};e.fn.scrollTop=function(e){var t=this;var n=t.editor;var a=t.$txt;if(n.useMaxHeight){return a.parent().scrollTop(e)}else{return a.scrollTop(e)}};e.fn.showHeightOnHover=function(){var e=this.editor;var f=e.$editorContainer;var d=e.menuContainer;var v=this.$txt;var m=c('<i class="height-tip"><i>');var p=false;function t(e){if(!p){f.append(m);p=true}var t=v.position().top;var n=v.outerHeight();var a=e.height();var i=e.position().top;var r=parseInt(e.css("margin-top"),10);var o=parseInt(e.css("padding-top"),10);var l=parseInt(e.css("margin-bottom"),10);var c=parseInt(e.css("padding-bottom"),10);var s=a+o+r+c+l;var u=i+d.height();m.css({height:a+o+r+c+l,top:i+d.height()})}function n(){if(!p){return}m.remove();p=false}v.on("mouseenter","ul,ol,blockquote,p,h1,h2,h3,h4,h5,table,pre",function(e){t(c(e.currentTarget))}).on("mouseleave",function(){n()})}});e(function(n,a){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){var t=0,n=this.length;for(;t<n;t++){if(this[t]===e){return t}}return-1};Array.prototype.lastIndexOf=function(e){var t=this.length;for(t=t-1;t>=0;t--){if(this[t]===e){return t}}return-1}}if(!Date.now){Date.now=function(){return(new Date).valueOf()}}var i=window.console;var r=function(){};a.each(["info","log","warn","error"],function(e,t){if(i==null){n[t]=r}else{n[t]=function(e){if(n.config&&n.config.printLog){i[t]("wangEditor提示: "+e)}}}});n.random=function(){return Math.random().toString().slice(2)};n.placeholder="placeholder"in document.createElement("input");n.placeholderForIE8=function(e){if(n.placeholder){return}e.find("input[placeholder]").each(function(){var e=a(this);var t=e.attr("placeholder");if(e.val()===""){e.css("color","#666");e.val(t);e.on("focus.placeholder click.placeholder",function(){e.val("");e.css("color","#333");e.off("focus.placeholder click.placeholder")})}})}});e(function(e,t){e.langs={};e.langs["zh-cn"]={bold:"粗体",underline:"下划线",italic:"斜体",forecolor:"文字颜色",bgcolor:"背景色",strikethrough:"删除线",eraser:"清空格式",source:"源码",quote:"引用",fontfamily:"字体",fontsize:"字号",head:"标题",orderlist:"有序列表",unorderlist:"无序列表",alignleft:"左对齐",aligncenter:"居中",alignright:"右对齐",link:"链接",text:"文本",submit:"提交",cancel:"取消",unlink:"取消链接",table:"表格",emotion:"表情",img:"图片",uploadImg:"上传图片",linkImg:"网络图片",video:"视频",width:"宽",height:"高",location:"位置",loading:"加载中",searchlocation:"搜索位置",dynamicMap:"动态地图",clearLocation:"清除位置",langDynamicOneLocation:"动态地图只能显示一个位置",insertcode:"插入代码",undo:"撤销",redo:"重复",fullscreen:"全屏",openLink:"打开链接"};e.langs.en={bold:"Bold",underline:"Underline",italic:"Italic",forecolor:"Color",bgcolor:"Backcolor",strikethrough:"Strikethrough",eraser:"Eraser",source:"Codeview",quote:"Quote",fontfamily:"Font family",fontsize:"Font size",head:"Head",orderlist:"Ordered list",unorderlist:"Unordered list",alignleft:"Align left",aligncenter:"Align center",alignright:"Align right",link:"Insert link",text:"Text",submit:"Submit",cancel:"Cancel",unlink:"Unlink",table:"Table",emotion:"Emotions",img:"Image",uploadImg:"Upload",linkImg:"Link",video:"Video",width:"width",height:"height",location:"Location",loading:"Loading",searchlocation:"search",dynamicMap:"Dynamic",clearLocation:"Clear",langDynamicOneLocation:"Only one location in dynamic map",insertcode:"Insert Code",undo:"Undo",redo:"Redo",fullscreen:"Full screnn",openLink:"open link"}});e(function(e,t){e.config={};e.config.zindex=1e4;e.config.printLog=true;e.config.menuFixed=0;e.config.jsFilter=true;e.config.legalTags="p,h1,h2,h3,h4,h5,h6,blockquote,table,ul,ol,pre";e.config.lang=e.langs["zh-cn"];e.config.menus=["source","|","bold","underline","italic","strikethrough","eraser","forecolor","bgcolor","|","quote","fontfamily","fontsize","head","unorderlist","orderlist","alignleft","aligncenter","alignright","|","link","unlink","table","emotion","|","img","video","location","insertcode","|","undo","redo","fullscreen"];e.config.colors={"#880000":"暗红色","#800080":"紫色","#ff0000":"红色","#ff00ff":"鲜粉色","#000080":"深蓝色","#0000ff":"蓝色","#00ffff":"湖蓝色","#008080":"蓝绿色","#008000":"绿色","#808000":"橄榄色","#00ff00":"浅绿色","#ffcc00":"橙黄色","#808080":"灰色","#c0c0c0":"银色","#000000":"黑色","#ffffff":"白色"};e.config.familys=["宋体","黑体","楷体","微软雅黑","Arial","Verdana","Georgia","Times New Roman","Microsoft JhengHei","Trebuchet MS","Courier New","Impact","Comic Sans MS","Consolas"];e.config.fontsizes={1:"12px",2:"13px",3:"16px",4:"18px",5:"24px",6:"32px",7:"48px"};e.config.emotionsShow="icon";e.config.emotions={weibo:{title:"微博表情",data:[{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/7a/shenshou_thumb.gif",value:"[草泥马]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/60/horse2_thumb.gif",value:"[神马]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c9/geili_thumb.gif",value:"[给力]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/f2/wg_thumb.gif",value:"[围观]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/70/vw_thumb.gif",value:"[威武]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6e/panda_thumb.gif",value:"[熊猫]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/81/rabbit_thumb.gif",value:"[兔子]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/15/j_thumb.gif",value:"[囧]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/89/hufen_thumb.gif",value:"[互粉]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c4/liwu_thumb.gif",value:"[礼物]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]"},{icon:"https://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/0b/tootha_thumb.gif",value:"[哈哈]"}]}};e.config.mapAk="TVhjYjq1ICT2qqL5LdS8mwas";e.config.uploadImgUrl="";e.config.uploadTimeout=20*1e3;e.config.uploadImgFns={};e.config.customUpload=false;e.config.uploadParams={};e.config.uploadHeaders={};e.config.withCredentials=true;e.config.hideLinkImg=false;e.config.pasteFilter=true;e.config.pasteText=false;e.config.codeDefaultLang="javascript"});e(function(e,t){e.UI={};e.UI.menus={"default":{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-command"></i></a>',selected:".selected"},bold:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-bold"></i></a>',selected:".selected"},underline:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-underline"></i></a>',selected:".selected"},italic:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-italic"></i></a>',selected:".selected"},forecolor:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-pencil"></i></a>',selected:".selected"},bgcolor:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-brush"></i></a>',selected:".selected"},strikethrough:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-strikethrough"></i></a>',selected:".selected"},eraser:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-eraser"></i></a>',selected:".selected"},quote:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-quotes-left"></i></a>',selected:".selected"},source:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-code"></i></a>',selected:".selected"},fontfamily:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-font2"></i></a>',selected:".selected"},fontsize:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-text-height"></i></a>',selected:".selected"},head:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-header"></i></a>',selected:".selected"},orderlist:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-list-numbered"></i></a>',selected:".selected"},unorderlist:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-list-bullet"></i></a>',selected:".selected"},alignleft:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-align-left"></i></a>',selected:".selected"},aligncenter:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-align-center"></i></a>',selected:".selected"},alignright:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-align-right"></i></a>',selected:".selected"},link:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-link"></i></a>',selected:".selected"},unlink:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-unlink"></i></a>',selected:".selected"},table:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-table"></i></a>',selected:".selected"},emotion:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-happy"></i></a>',selected:".selected"},img:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-picture"></i></a>',selected:".selected"},video:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-play"></i></a>',selected:".selected"},location:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-location"></i></a>',selected:".selected"},insertcode:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-terminal"></i></a>',selected:".selected"},undo:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-ccw"></i></a>',selected:".selected"},redo:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-cw"></i></a>',selected:".selected"},fullscreen:{normal:'<a href="#" tabindex="-1"><i class="wangeditor-menu-img-enlarge2"></i></a>',selected:'<a href="#" tabindex="-1" class="selected"><i class="wangeditor-menu-img-shrink2"></i></a>'}}});e(function(t,n){t.fn.initDefaultConfig=function(){var e=this;e.config=n.extend({},t.config);e.UI=n.extend({},t.UI)}});e(function(e,t){e.fn.addEditorContainer=function(){this.$editorContainer=t('<div class="wangEditor-container"></div>')}});e(function(n,e){n.fn.addTxt=function(){var e=this;var t=new n.Txt(e);e.txt=t}});e(function(t,e){t.fn.addMenuContainer=function(){var e=this;e.menuContainer=new t.MenuContainer(e)}});e(function(i,e){i.createMenuFns=[];i.createMenu=function(e){i.createMenuFns.push(e)};i.fn.addMenus=function(){var n=this;var t=n.config.menus;function a(e){if(t.indexOf(e)>=0){return true}return false}e.each(i.createMenuFns,function(e,t){t.call(n,a)})}});e(function(r,e){r.createMenu(function(e){var t="bold";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.bold,commandName:"Bold"});i.clickEventSelected=function(e){var t=n.isRangeEmpty();if(!t){n.command(e,"Bold")}else{n.commandForElem("b,strong,h1,h2,h3,h4,h5",e,"Bold")}};n.menus[t]=i})});e(function(r,e){r.createMenu(function(e){var t="underline";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.underline,commandName:"Underline"});i.clickEventSelected=function(e){var t=n.isRangeEmpty();if(!t){n.command(e,"Underline")}else{n.commandForElem("u,a",e,"Underline")}};n.menus[t]=i})});e(function(r,e){r.createMenu(function(e){var t="italic";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.italic,commandName:"Italic"});i.clickEventSelected=function(e){var t=n.isRangeEmpty();if(!t){n.command(e,"Italic")}else{n.commandForElem("i",e,"Italic")}};n.menus[t]=i})});e(function(l,c){l.createMenu(function(e){var t="forecolor";if(!e(t)){return}var a=this;var n=a.config.lang;var i=a.config.colors;var r=new l.Menu({editor:a,id:t,title:n.forecolor});var o=c("<div></div>");c.each(i,function(e,t){o.append(['<a href="#" class="color-item"','    title="'+t+'" commandValue="'+e+'" ','    style="color: '+e+'" ','><i class="wangeditor-menu-img-pencil"></i></a>'].join(""))});o.on("click","a[commandValue]",function(e){var t=c(this);var n=t.attr("commandValue");if(r.selected&&a.isRangeEmpty()){a.commandForElem("font[color]",e,"forecolor",n)}else{a.command(e,"forecolor",n)}});r.dropPanel=new l.DropPanel(a,r,{$content:o,width:125});r.updateSelectedEvent=function(){var e=a.getRangeElem();e=a.getSelfOrParentByName(e,"font[color]");if(e){return true}return false};a.menus[t]=r})});e(function(c,s){c.createMenu(function(e){var t="bgcolor";if(!e(t)){return}var a=this;var n=a.config.lang;var i=a.config.colors;function r(e){var t;if(e&&e.style&&e.style.cssText!=null){t=e.style.cssText;if(t&&t.indexOf("background-color:")>=0){return true}}return false}var o=new c.Menu({editor:a,id:t,title:n.bgcolor});var l=s("<div></div>");s.each(i,function(e,t){l.append(['<a href="#" class="color-item"','    title="'+t+'" commandValue="'+e+'" ','    style="color: '+e+'" ','><i class="wangeditor-menu-img-brush"></i></a>'].join(""))});l.on("click","a[commandValue]",function(e){var t=s(this);var n=t.attr("commandValue");if(o.selected&&a.isRangeEmpty()){a.commandForElem({selector:"span,font",check:r},e,"BackColor",n)}else{a.command(e,"BackColor",n)}});o.dropPanel=new c.DropPanel(a,o,{$content:l,width:125});o.updateSelectedEvent=function(){var e=a.getRangeElem();e=a.getSelfOrParentByName(e,"span,font",r);if(e){return true}return false};a.menus[t]=o})});e(function(r,e){r.createMenu(function(e){var t="strikethrough";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.strikethrough,commandName:"StrikeThrough"});i.clickEventSelected=function(e){var t=n.isRangeEmpty();if(!t){n.command(e,"StrikeThrough")}else{n.commandForElem("strike",e,"StrikeThrough")}};n.menus[t]=i})});e(function(r,s){r.createMenu(function(e){var t="eraser";if(!e(t)){return}var i=this;var n=i.config.lang;var a=new r.Menu({editor:i,id:t,title:n.eraser,commandName:"RemoveFormat"});a.clickEvent=function(e){var t=i.isRangeEmpty();if(!t){i.command(e,"RemoveFormat");return}var c;function n(){var e=this;var t;var n,a;var i,r;var o,l;t=e.getRangeElem();i=e.getSelfOrParentByName(t,"blockquote");if(i){r=s(i);c=s("<p>"+r.text()+"</p>");r.after(c).remove()}n=e.getSelfOrParentByName(t,"p,h1,h2,h3,h4,h5");if(n){a=s(n);c=s("<p>"+a.text()+"</p>");a.after(c).remove()}o=e.getSelfOrParentByName(t,"ul,ol");if(o){l=s(o);c=s("<p>"+l.text()+"</p>");l.after(c).remove()}}function a(){var e=this;if(c){e.restoreSelectionByElem(c.get(0))}}i.customCommand(e,n,a)};i.menus[t]=a})});e(function(a,u){a.createMenu(function(e){var t="source";if(!e(t)){return}var i=this;var n=i.config.lang;var l;var c=new a.Menu({editor:i,id:t,title:n.source});c.isShowCode=false;function s(){var e=c.$codeTextarea;var t=i.txt.$txt;var n=u.trim(e.val());if(!n){n="<p><br></p>"}if(i.config.jsFilter){n=n.replace(/<script[\s\S]*?<\/script>/gi,"")}try{t.html(n)}catch(a){}}c.clickEvent=function(e){var t=this;var n=t.editor;var a=n.txt.$txt;var i=a.outerHeight();var r=a.height();if(!t.$codeTextarea){t.$codeTextarea=u('<textarea class="code-textarea"></textarea>')}var o=t.$codeTextarea;o.css({height:r,"margin-top":i-r});o.val(a.html());o.on("change",function(e){s()});a.after(o).hide();o.show();c.isShowCode=true;this.updateSelected();n.disableMenusExcept("source");l=a.html()};c.clickEventSelected=function(e){var t=this;var n=t.editor;var a=n.txt.$txt;var i=t.$codeTextarea;var r;if(!i){return}s();i.after(a).hide();a.show();c.isShowCode=false;this.updateSelected();n.enableMenusExcept("source");if(a.html()!==l){if(n.onchange&&typeof n.onchange==="function"){n.onchange.call(n)}}};c.updateSelectedEvent=function(){return this.isShowCode};i.menus[t]=c})});e(function(i,c){i.createMenu(function(e){var t="quote";if(!e(t)){return}var l=this;var n=l.config.lang;var a=new i.Menu({editor:l,id:t,title:n.quote,commandName:"formatBlock",commandValue:"blockquote"});a.clickEvent=function(e){var t=l.getRangeElem();var n;if(!t){e.preventDefault();return}var a=l.getSelfOrParentByName(t,"blockquote");var i;if(a){e.preventDefault();return}t=l.getLegalTags(t);n=c(t);if(!n.text()){return}if(!t){l.command(e,"formatBlock","blockquote");return}function r(){i=c("<p>"+n.text()+"</p>");n.after(i).remove();i.wrap("<blockquote>")}function o(){var e=this;if(i){e.restoreSelectionByElem(i.get(0))}}l.customCommand(e,r,o)};a.clickEventSelected=function(e){var t;var a;var i;t=l.getRangeElem();a=l.getSelfOrParentByName(t,"blockquote");if(!a){e.preventDefault();return}function n(){var n;var e;n=c(a);e=n.children();if(e.length){e.each(function(e){var t=c(this);if(t.get(0).nodeName==="P"){n.after(t)}else{n.after("<p>"+t.text()+"</p>")}i=t});n.remove();return}}function r(){var e=this;if(i){e.restoreSelectionByElem(i.get(0))}}l.customCommand(e,n,r)};a.updateSelectedEvent=function(){var e=this;var t=e.editor;var n;n=t.getRangeElem();n=t.getSelfOrParentByName(n,"blockquote");if(n){return true}return false};l.menus[t]=a;l.ready(function(){var i=this;var e=i.txt.$txt;var r=false;e.on("keydown",function(e){if(e.keyCode!==13){r=false;return}var t=i.getRangeElem();t=i.getSelfOrParentByName(t,"blockquote");if(!t){r=false;return}if(!r){r=true;return}var n=i.getRangeElem();var a=c(n);if(a.length){a.parent().after(a)}i.restoreSelectionByElem(n,"start");r=false;e.preventDefault()})});l.ready(function(){var a=this;var e=a.txt.$txt;var i;function r(){i&&i.remove()}function o(){if(!i){return}var e=i.prev();if(e.length){a.restoreSelectionByElem(e.get(0))}else{a.initSelection()}}e.on("keydown",function(e){if(e.keyCode!==8){return}var t=a.getRangeElem();t=a.getSelfOrParentByName(t,"blockquote");if(!t){return}i=c(t);var n=i.text();if(n){return}a.customCommand(e,r,o)})})})});e(function(c,s){c.createMenu(function(e){var t="fontfamily";if(!e(t)){return}var n=this;var a=n.config.lang;var i=n.config.familys;var r=new c.Menu({editor:n,id:t,title:a.fontfamily,commandName:"fontName"});var o={};s.each(i,function(e,t){o[t]=t});var l='<span style="font-family:{#commandValue};">{#title}</span>';r.dropList=new c.DropList(n,r,{data:o,tpl:l,selectorForELemCommand:"font[face]"});r.updateSelectedEvent=function(){var e=n.getRangeElem();e=n.getSelfOrParentByName(e,"font[face]");if(e){return true}return false};n.menus[t]=r})});e(function(c,e){c.createMenu(function(e){var t="fontsize";if(!e(t)){return}var n=this;var a=n.config.lang;var i=n.config.fontsizes;var r=new c.Menu({editor:n,id:t,title:a.fontsize,commandName:"fontSize"});var o=i;var l='<span style="font-size:{#title};">{#title}</span>';r.dropList=new c.DropList(n,r,{data:o,tpl:l,selectorForELemCommand:"font[size]"});r.updateSelectedEvent=function(){var e=n.getRangeElem();e=n.getSelfOrParentByName(e,"font[size]");if(e){return true}return false};n.menus[t]=r})});e(function(u,e){u.createMenu(function(e){var t="head";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new u.Menu({editor:n,id:t,title:a.head,commandName:"formatBlock"});var r={"<h1>":"标题1","<h2>":"标题2","<h3>":"标题3","<h4>":"标题4","<h5>":"标题5"};var o;function l(e){if(n.queryCommandState("InsertOrderedList")){o=true;n.command(e,"InsertOrderedList")}else{o=false}}function c(e){if(o){n.command(e,"InsertOrderedList")}}var s="{#commandValue}{#title}";i.dropList=new u.DropList(n,i,{data:r,tpl:s,beforeEvent:l,afterEvent:c});i.updateSelectedEvent=function(){var e=n.getRangeElem();e=n.getSelfOrParentByName(e,"h1,h2,h3,h4,h5");if(e){return true}return false};n.menus[t]=i})});e(function(r,e){r.createMenu(function(e){var t="unorderlist";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.unorderlist,commandName:"InsertUnorderedList"});n.menus[t]=i})});e(function(r,e){r.createMenu(function(e){var t="orderlist";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.orderlist,commandName:"InsertOrderedList"});n.menus[t]=i})});e(function(r,o){r.createMenu(function(e){var t="alignleft";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.alignleft,commandName:"JustifyLeft"});i.updateSelectedEvent=function(){var e=n.getRangeElem();e=n.getSelfOrParentByName(e,"p,h1,h2,h3,h4,h5,li",function(e){var t;if(e&&e.style&&e.style.cssText!=null){t=e.style.cssText;if(t&&/text-align:\s*left;/.test(t)){return true}}if(o(e).attr("align")==="left"){return true}return false});if(e){return true}return false};n.menus[t]=i})});e(function(r,o){r.createMenu(function(e){var t="aligncenter";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.aligncenter,commandName:"JustifyCenter"});i.updateSelectedEvent=function(){var e=n.getRangeElem();e=n.getSelfOrParentByName(e,"p,h1,h2,h3,h4,h5,li",function(e){var t;if(e&&e.style&&e.style.cssText!=null){t=e.style.cssText;if(t&&/text-align:\s*center;/.test(t)){return true}}if(o(e).attr("align")==="center"){return true}return false});if(e){return true}return false};n.menus[t]=i})});e(function(r,o){r.createMenu(function(e){var t="alignright";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.alignright,commandName:"JustifyRight"});i.updateSelectedEvent=function(){var e=n.getRangeElem();e=n.getSelfOrParentByName(e,"p,h1,h2,h3,h4,h5,li",function(e){var t;if(e&&e.style&&e.style.cssText!=null){t=e.style.cssText;if(t&&/text-align:\s*right;/.test(t)){return true}}if(o(e).attr("align")==="right"){return true}return false});if(e){return true}return false};n.menus[t]=i})});e(function(w,x){w.createMenu(function(e){var t="link";if(!e(t)){return}var m=this;var n=m.config.lang;var p=new w.Menu({editor:m,id:t,title:n.link});var a=x("<div></div>");var i=x('<div style="margin:20px 10px;" class="clearfix"></div>');var r=i.clone();var o=i.clone().css("margin","0 10px");var h=x('<input type="text" class="block" placeholder="'+n.text+'"/>');var g=x('<input type="text" class="block" placeholder="'+n.link+'"/>');var l=x('<button class="right">'+n.submit+"</button>");var c=x('<button class="right gray">'+n.cancel+"</button>");i.append(h);r.append(g);o.append(l).append(c);a.append(i).append(r).append(o);p.dropPanel=new w.DropPanel(m,p,{$content:a,width:300});p.clickEvent=function(e){var t=this;var n=t.dropPanel;if(n.isShowing){n.hide();return}h.val("");g.val("https://");var a="";var i=m.getRangeElem();i=m.getSelfOrParentByName(i,"a");if(i){a=i.href||""}var r="";var o=m.isRangeEmpty();if(!o){r=m.getRangeText()||""}else if(i){r=i.textContent||i.innerHTML}a&&g.val(a);r&&h.val(r);if(!o){h.attr("disabled",true)}else{h.removeAttr("disabled")}n.show()};p.updateSelectedEvent=function(){var e=m.getRangeElem();e=m.getSelfOrParentByName(e,"a");if(e){return true}return false};c.click(function(e){e.preventDefault();p.dropPanel.hide()});l.click(function(e){e.preventDefault();var t=m.getRangeElem();var n=m.getSelfOrParentByName(t,"a");var a=m.isRangeEmpty();var i,r;var o,l;var c=m.txt.$txt;var s,u;var f="link"+w.random();var d=x.trim(g.val());var v=x.trim(h.val());if(!d){p.dropPanel.focusFirstInput();return}if(!v){v=d}if(!a){s=c.find("a");s.attr(f,"1");m.command(e,"createLink",d);u=c.find("a").not("["+f+"]");u.attr("target","_blank");s.removeAttr(f)}else if(n){i=x(n);o=function(){i.attr("href",d);i.text(v)};l=function(){var e=this;e.restoreSelectionByElem(n)};m.customCommand(e,o,l)}else{r='<a href="'+d+'" target="_blank">'+v+"</a>";if(w.userAgent.indexOf("Firefox")>0){r+="<span>&nbsp;</span>"}m.command(e,"insertHtml",r)}});m.menus[t]=p})});e(function(i,s){i.createMenu(function(e){var t="unlink";if(!e(t)){return}var c=this;var n=c.config.lang;var a=new i.Menu({editor:c,id:t,title:n.unlink,commandName:"unLink"});a.clickEvent=function(e){var t=c.isRangeEmpty();if(!t){c.command(e,"unLink");return}var n=c.getRangeElem();var a=c.getSelfOrParentByName(n,"a");if(!a){e.preventDefault();return}var i=s(a);var r=s("<span>"+i.text()+"</span>");function o(){i.after(r).remove()}function l(){c.restoreSelectionByElem(r.get(0))}c.customCommand(e,o,l)};c.menus[t]=a})});e(function(m,p){m.createMenu(function(e){var t="table";if(!e(t)){return}var u=this;var n=u.config.lang;var a=new m.Menu({editor:u,id:t,title:n.table});var i=p('<div style="font-size: 14px; color: #666; text-align:right;"></div>');var r=p('<table class="choose-table" style="margin-bottom:10px;margin-top:5px;">');var o=p("<span>0</span>");var l=p("<span> 行 </span>");var c=p("<span>0</span>");var s=p("<span> 列</span>");var f;var d,v;for(d=0;d<15;d++){f=p('<tr index="'+(d+1)+'">');for(v=0;v<20;v++){f.append(p('<td index="'+(v+1)+'">'))}r.append(f)}i.append(r);i.append(o).append(l).append(c).append(s);r.on("mouseenter","td",function(e){var t=p(e.currentTarget);var n=t.attr("index");var a=t.parent();var i=a.attr("index");o.text(i);c.text(n);r.find("tr").each(function(){var e=p(this);var t=e.attr("index");if(parseInt(t,10)<=parseInt(i,10)){e.find("td").each(function(){var e=p(this);var t=e.attr("index");if(parseInt(t,10)<=parseInt(n,10)){e.addClass("active")}else{e.removeClass("active")}})}else{e.find("td").removeClass("active")}})}).on("mouseleave",function(e){r.find("td").removeClass("active");o.text(0);c.text(0)});r.on("click","td",function(e){var t=p(e.currentTarget);var n=t.attr("index");var a=t.parent();var i=a.attr("index");var r=parseInt(i,10);var o=parseInt(n,10);var l,c;var s="<table>";for(l=0;l<r;l++){s+="<tr>";for(c=0;c<o;c++){s+="<td><span>&nbsp;</span></td>"}s+="</tr>"}s+="</table>";u.command(e,"insertHtml",s)});a.dropPanel=new m.DropPanel(u,a,{$content:i,width:262});u.menus[t]=a})});e(function(d,v){d.createMenu(function(e){var t="emotion";if(!e(t)){return}var c=this;var n=c.config;var a=n.lang;var i=n.emotions;var s=n.emotionsShow;c.emotionUrls=[];var r=new d.Menu({editor:c,id:t,title:a.emotion});function o(e,l){v.each(e,function(e,t){var n=t.icon||t.url;var a=t.value||t.title;var i=s==="icon"?n:a;var r=v('<a href="#" commandValue="'+i+'"></a>');var o=v("<img>");o.attr("_src",n);r.append(o);l.append(r);c.emotionUrls.push(n)})}var l=v('<div class="panel-tab"></div>');var u=v('<div class="tab-container"></div>');var f=v('<div class="content-container emotion-content-container"></div>');v.each(i,function(e,t){var n=t.title;var a=t.data;d.log("正在处理 "+n+" 表情的数据...");var i=v('<a href="#">'+n+" </a>");u.append(i);var r=v('<div class="content"></div>');f.append(r);i.click(function(e){u.children().removeClass("selected");f.children().removeClass("selected");r.addClass("selected");i.addClass("selected");e.preventDefault()});if(typeof a==="string"){d.log("将通过 "+a+" 地址ajax下载表情包");v.get(a,function(e){e=v.parseJSON(e);d.log("下载完毕，得到 "+e.length+" 个表情");o(e,r)})}else if(Object.prototype.toString.call(a).toLowerCase().indexOf("array")>0){o(a,r)}else{d.error("data 数据格式错误，请修改为正确格式，参考文档："+d.docsite);return}});l.append(u).append(f);u.children().first().addClass("selected");f.children().first().addClass("selected");f.on("click","a[commandValue]",function(e){var t=v(e.currentTarget);var n=t.attr("commandValue");var a;if(s==="icon"){c.command(e,"InsertImage",n)}else{c.command(e,"insertHtml","<span>"+n+"</span>")}e.preventDefault()});r.dropPanel=new d.DropPanel(c,r,{$content:l,width:350});r.clickEvent=function(e){var t=this;var n=t.dropPanel;if(n.isShowing){n.hide();return}n.show();if(t.imgLoaded){return}f.find("img").each(function(){var e=v(this);var t=e.attr("_src");e.on("error",function(){d.error("加载不出表情图片 "+t)});e.attr("src",t);e.removeAttr("_src")});t.imgLoaded=true};c.menus[t]=r})});e(function(p,h){p.createMenu(function(e){var t="img";if(!e(t)){return}var n=this;var a=n.config.lang;var l=new p.Menu({editor:n,id:t,title:a.img});var i=h('<div class="panel-tab"></div>');var r=h('<div class="tab-container"></div>');var o=h('<div class="content-container"></div>');i.append(r).append(o);var c=h('<a href="#">'+a.uploadImg+"</a>");var s=h('<a href="#">'+a.linkImg+"</a>");r.append(c).append(s);var u=h('<div class="content"></div>');o.append(u);var f=h('<div class="content"></div>');o.append(f);g(n,l,f);l.dropPanel=new p.DropPanel(n,l,{$content:i,width:400,onRender:function(){var e=n.config.customUploadInit;e&&e.call(n)}});n.menus[t]=l;function d(){c.click(function(e){r.children().removeClass("selected");o.children().removeClass("selected");u.addClass("selected");c.addClass("selected");e.preventDefault()});s.click(function(e){r.children().removeClass("selected");o.children().removeClass("selected");f.addClass("selected");s.addClass("selected");e.preventDefault();if(p.placeholder){f.find("input[type=text]").focus()}});c.click()}function v(){r.remove();u.remove();f.addClass("selected")}function m(){r.remove();f.remove();u.addClass("selected")}n.ready(function(){var e=this;var t=e.config;var n=t.uploadImgUrl;var a=t.customUpload;var i=t.hideLinkImg;var r;if(n||a){e.$uploadContent=u;d();if(i){m()}}else{v()}function o(){l.dropPanel.hide()}u.click(function(){setTimeout(o)})})});function g(a,t,e){var n=a.config.lang;var i=h('<div style="margin:20px 10px 10px 10px;"></div>');var r=h('<input type="text" class="block" placeholder="https://"/>');i.append(r);var o=h('<button class="right">'+n.submit+"</button>");var l=h('<button class="right gray">'+n.cancel+"</button>");e.append(i).append(o).append(l);l.click(function(e){e.preventDefault();t.dropPanel.hide()});function c(){r.val("")}o.click(function(e){e.preventDefault();var t=h.trim(r.val());if(!t){r.focus();return}var n='<img style="max-width:100%;" src="'+t+'"/>';a.command(e,"insertHtml",n,c)})}});e(function(h,g){h.createMenu(function(e){var t="video";if(!e(t)){return}var l=this;var n=l.config.lang;var c=/^<(iframe)|(embed)/i;var s=new h.Menu({editor:l,id:t,title:n.video});var a=g("<div></div>");var i=g('<div style="margin:20px 10px;"></div>');var u=g('<input type="text" class="block" placeholder=\'格式如：<iframe src="..." frameborder=0 allowfullscreen></iframe>\'/>');i.append(u);var r=g('<div style="margin:20px 10px;"></div>');var f=g('<input type="text" value="640" style="width:50px;text-align:center;"/>');var d=g('<input type="text" value="498" style="width:50px;text-align:center;"/>');r.append("<span> "+n.width+" </span>").append(f).append("<span> px &nbsp;&nbsp;&nbsp;</span>").append("<span> "+n.height+" </span>").append(d).append("<span> px </span>");var o=g("<div></div>");var v=g('<a href="https://kancloud.cn/wangfupeng/wangeditor2/134973" target="_blank" style="display:inline-block;margin-top:10px;margin-left:10px;color:#999;">如何复制视频链接？</a>');var m=g('<button class="right">'+n.submit+"</button>");var p=g('<button class="right gray">'+n.cancel+"</button>");o.append(v).append(m).append(p);a.append(i).append(r).append(o);p.click(function(e){e.preventDefault();u.val("");s.dropPanel.hide()});m.click(function(e){e.preventDefault();var t=g.trim(u.val());var n;var a=parseInt(f.val());var i=parseInt(d.val());var r=g("<div>");var o="<p>{content}</p>";if(!t){s.dropPanel.focusFirstInput();return}if(!c.test(t)){alert("视频链接格式错误！");s.dropPanel.focusFirstInput();return}if(isNaN(a)||isNaN(i)){alert("宽度或高度不是数字！");return}n=g(t);n.attr("width",a).attr("height",i);o=o.replace("{content}",r.append(n).html());l.command(e,"insertHtml",o);u.val("")});s.dropPanel=new h.DropPanel(l,s,{$content:a,width:400});l.menus[t]=s})});e(function(E,k){var C=function(e){return"onkeyup"in e}(document.createElement("input"));E.baiduMapAk="TVhjYjq1ICT2qqL5LdS8mwas";E.numberOfLocation=0;E.createMenu(function(e){var t="location";if(!e(t)){return}if(++E.numberOfLocation>1){E.error("目前不支持在一个页面多个编辑器上同时使用地图，可通过自定义菜单配置去掉地图菜单");return}var m=this;var n=m.config;var p=n.lang;var a=n.mapAk;m.mapData={};var h=m.mapData;h.markers=[];h.mapContainerId="map"+E.random();h.clearLocations=function(){var e=h.map;if(!e){return}e.clearOverlays();h.markers=[]};h.searchMap=function(){var t=h.map;if(!t){return}var n=window.BMap;var a=c.val();var e=s.val();var i,r;if(a!==""){if(!e||e===""){t.centerAndZoom(a,11)}if(e&&e!==""){i=new n.Geocoder;i.getPoint(e,function(e){if(e){t.centerAndZoom(e,13);r=new n.Marker(e);t.addOverlay(r);r.enableDragging();h.markers.push(r)}else{t.centerAndZoom(a,11)}},a)}}};var i=false;window.baiduMapCallBack=function(){if(i){return}else{i=true}var n=window.BMap;if(!h.map){h.map=new n.Map(h.mapContainerId)}var a=h.map;a.centerAndZoom(new n.Point(116.404,39.915),11);a.addControl(new n.MapTypeControl);a.setCurrentCity("北京");a.enableScrollWheelZoom(true);function e(e){var t=e.name;a.setCenter(t);c.val(t);if(E.placeholder){s.focus()}var i,r;if(C){r=function(e){if(e.type==="keyup"&&e.keyCode===13){e.preventDefault()}if(i){clearTimeout(i)}i=setTimeout(h.searchMap,500)};c.on("keyup change paste",r);s.on("keyup change paste",r)}else{r=function(){if(!o.is(":visible")){clearTimeout(i);return}var e="";var t="";var n=c.val();var a=s.val();if(n!==e||a!==t){h.searchMap();e=n;t=a}if(i){clearTimeout(i)}i=setTimeout(r,1e3)};i=setTimeout(r,1e3)}}var t=new n.LocalCity;t.get(e);a.addEventListener("click",function(e){var t=new n.Marker(new n.Point(e.point.lng,e.point.lat));a.addOverlay(t);t.enableDragging();h.markers.push(t)},false)};h.loadMapScript=function(){var e=document.createElement("script");e.type="text/javascript";e.src="https://api.map.baidu.com/api?v=2.0&ak="+a+"&s=1&callback=baiduMapCallBack";try{document.body.appendChild(e)}catch(t){E.error("加载地图过程中发生错误")}};h.initMap=function(){if(window.BMap){window.baiduMapCallBack()}else{h.loadMapScript()}};var r=new E.Menu({editor:m,id:t,title:p.location});m.menus[t]=r;var o=k("<div></div>");var l=k('<div style="margin:10px 0;"></div>');var c=k('<input type="text"/>');c.css({width:"80px","text-align":"center"});var s=k('<input type="text"/>');s.css({width:"300px","margin-left":"10px"}).attr("placeholder",p.searchlocation);var u=k('<button class="right link">'+p.clearLocation+"</button>");l.append(u).append(c).append(s);o.append(l);u.click(function(e){s.val("");s.focus();h.clearLocations();e.preventDefault()});var f=k('<div id="'+h.mapContainerId+'"></div>');f.css({height:"260px",width:"100%",position:"relative","margin-top":"10px",border:"1px solid #f1f1f1"});var d=k("<span>"+p.loading+"</span>");d.css({position:"absolute",width:"100px","text-align":"center",top:"45%",left:"50%","margin-left":"-50px"});f.append(d);o.append(f);var v=k('<div style="margin:10px 0;"></div>');var g=k('<button class="right">'+p.submit+"</button>");var w=k('<button class="right gray">'+p.cancel+"</button>");var x=k('<label style="display:inline-block;margin-top:10px;color:#666;"></label>');var y=k('<input type="checkbox">');x.append(y).append('<span style="display:inline-block;margin-left:5px;">  '+p.dynamicMap+"</span>");v.append(x).append(g).append(w);o.append(v);function b(){s.val("")}w.click(function(e){e.preventDefault();b();r.dropPanel.hide()});g.click(function(e){e.preventDefault();var t=h.map,n=y.is(":checked"),a=h.markers,i=t.getCenter(),r=i.lng,o=i.lat,l=t.getZoom(),c=t.getSize(),s=c.width,u=c.height,f,d,v;if(n){d="https://ueditor.baidu.com/ueditor/dialogs/map/show.html#"}else{d="https://api.map.baidu.com/staticimage?"}d=d+"center="+r+","+o+"&zoom="+l+"&width="+s+"&height="+u;if(a.length>0){d=d+"&markers=";k.each(a,function(e,t){f=t.getPosition();if(e>0){d=d+"|"}d=d+f.lng+","+f.lat})}if(n){if(a.length>1){alert(p.langDynamicOneLocation);return}d+="&markerStyles=l,A";v='<iframe class="ueditor_baidumap" src="{src}" frameborder="0" width="'+s+'" height="'+u+'"></iframe>';v=v.replace("{src}",d);m.command(e,"insertHtml",v,b)}else{m.command(e,"insertHtml",'<img style="max-width:100%;" src="'+d+'"/>',b)}});r.dropPanel=new E.DropPanel(m,r,{$content:o,width:500});r.onRender=function(){if(a===E.baiduMapAk){E.warn("建议在配置中自定义百度地图的mapAk，否则可能影响地图功能，文档："+E.docsite)}};r.clickEvent=function(e){var t=this;var n=t.dropPanel;var a=false;if(n.isShowing){n.hide();return}if(!h.map){a=true}n.show();h.initMap();if(!a){s.focus()}}})});e(function(l,g){function c(){if(l.userAgent.indexOf("MSIE 8")>0){return}if(window.hljs){return}var e=document.createElement("script");e.type="text/javascript";e.src="https://cdn.bootcss.com/highlight.js/9.15.6/highlight.min.js";document.body.appendChild(e)}l.createMenu(function(e){var t="insertcode";if(!e(t)){return}setTimeout(c,0);var d=this;var i=d.config;var r=i.lang;var v=d.txt.$txt;var m=new l.Menu({editor:d,id:t,title:r.insertcode});m.clickEvent=function(e){var t=this;var n=t.dropPanel;if(n.isShowing){n.hide();return}p.val("");n.show();var a=window.hljs;if(a&&a.listLanguages){if(h.children().length!==0){return}h.css({"margin-top":"9px","margin-left":"5px"});g.each(a.listLanguages(),function(e,t){if(t==="xml"){t="html"}if(t===i.codeDefaultLang){h.append('<option value="'+t+'" selected="selected">'+t+"</option>")}else{h.append('<option value="'+t+'">'+t+"</option>")}})}else{h.hide()}};m.clickEventSelected=function(e){var t=this;var n=t.dropPanel;if(n.isShowing){n.hide();return}n.show();var a=d.getRangeElem();var i=d.getSelfOrParentByName(a,"pre");var r;var o;if(i){i=d.getSelfOrParentByName(a,"code")}if(!i){return}r=g(i);p.val(r.text());if(h){o=r.attr("class");if(o){h.val(o.split(" ")[0])}}};m.updateSelectedEvent=function(){var e=this;var t=e.editor;var n;n=t.getRangeElem();n=t.getSelfOrParentByName(n,"pre");if(n){return true}return false};var n=g("<div></div>");var p=g("<textarea></textarea>");var h=g("<select></select>");a(n);m.dropPanel=new l.DropPanel(d,m,{$content:n,width:500});d.menus[t]=m;function a(e){var t=g("<div></div>");t.css({margin:"15px 5px 5px 5px",height:"160px","text-align":"center"});p.css({width:"100%",height:"100%",padding:"10px"});p.on("keydown",function(e){if(e.keyCode===9){e.preventDefault()}});t.append(p);e.append(t);var n=g("<div></div>");var a=g('<button class="right">'+r.submit+"</button>");var i=g('<button class="right gray">'+r.cancel+"</button>");n.append(a).append(i).append(h);e.append(n);i.click(function(e){e.preventDefault();m.dropPanel.hide()});var f='<pre style="max-width:100%;overflow-x:auto;"><code{#langClass}>{#content}</code></pre>';a.click(function(e){e.preventDefault();var t=p.val();if(!t){p.focus();return}var n=d.getRangeElem();if(g.trim(g(n).text())&&f.indexOf("<p><br></p>")!==0){f="<p><br></p>"+f}var a=h?h.val():"";var i="";var r=function(){v.find("pre code").each(function(e,t){var n=g(t);if(n.attr("codemark")){return}else if(window.hljs){window.hljs.highlightBlock(t);n.attr("codemark","1")}})};if(a){i=' class="'+a+' hljs"'}t=t.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;");if(!m.selected){var o=f.replace("{#langClass}",i).replace("{#content}",t);d.command(e,"insertHtml",o,r);return}var l=d.getSelfOrParentByName(n,"pre");var c;if(l){l=d.getSelfOrParentByName(n,"code")}if(!l){return}c=g(l);function s(){var e;if(a){e=c.attr("class");if(e!==a+" hljs"){c.attr("class",a+" hljs")}}c.html(t)}function u(){d.restoreSelectionByElem(l);r()}d.customCommand(e,s,u)})}v.on("keydown",function(e){if(e.keyCode!==13){return}var t=d.getRangeElem();var n=d.getSelfOrParentByName(t,"code");if(!n){return}d.command(e,"insertHtml","\n")});function o(){var e=d.getRangeElem();var t=d.getSelfOrParentByName(e,"code");if(t){d.disableMenusExcept("insertcode")}else{d.enableMenusExcept("insertcode")}}v.on("keydown click",function(e){setTimeout(o)})})});e(function(r,e){r.createMenu(function(e){var t="undo";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.undo});i.clickEvent=function(e){n.undo()};n.menus[t]=i;n.ready(function(){var n=this;var e=n.txt.$txt;var a;function i(){n.undoRecord()}e.on("keydown",function(e){var t=e.keyCode;if(e.ctrlKey&&t===90){n.undo();return}if(t===13){i()}else{if(a){clearTimeout(a)}a=setTimeout(i,1e3)}});n.undoRecord()})})});e(function(r,e){r.createMenu(function(e){var t="redo";if(!e(t)){return}var n=this;var a=n.config.lang;var i=new r.Menu({editor:n,id:t,title:a.redo});i.clickEvent=function(e){n.redo()};n.menus[t]=i})});e(function(d,e){var v;d.createMenu(function(e){var t="fullscreen";if(!e(t)){return}var o=this;var l=o.txt.$txt;var n=o.config;var c=n.zindex||1e4;var a=n.lang;var s=false;var u;var f;var i=new d.Menu({editor:o,id:t,title:a.fullscreen});i.clickEvent=function(e){var t=o.$editorContainer;t.addClass("wangEditor-fullscreen");u=t.css("z-index");t.css("z-index",c);var n;var a=l.height();var i=l.outerHeight();if(o.useMaxHeight){f=l.css("max-height");l.css("max-height","none");n=l.parent();n.after(l);n.remove();l.css("overflow-y","auto")}var r=o.menuContainer;l.height(d.$window.height()-r.height()-(i-a));o.menuContainer.$menuContainer.attr("style","");s=true;o.isFullScreen=true;v=d.$window.scrollTop()};i.clickEventSelected=function(e){var t=o.$editorContainer;t.removeClass("wangEditor-fullscreen");t.css("z-index",u);if(o.useMaxHeight){l.css("max-height",f)}else{o.$valueContainer.css("height",o.valueContainerHeight)}o.txt.initHeight();s=false;o.isFullScreen=false;if(v!=null){d.$window.scrollTop(v)}};i.updateSelectedEvent=function(e){return s};o.menus[t]=i})});e(function(e,o){e.fn.renderMenus=function(){var e=this;var n=e.menus;var t=e.config.menus;var a=e.menuContainer;var i;var r=0;o.each(t,function(e,t){if(t==="|"){r++;return}i=n[t];if(i){i.render(r)}})}});e(function(e,t){e.fn.renderMenuContainer=function(){var e=this;var t=e.menuContainer;var n=e.$editorContainer;t.render()}});e(function(e,t){e.fn.renderTxt=function(){var e=this;var t=e.txt;t.render();e.ready(function(){t.initHeight()})}});e(function(e,t){e.fn.renderEditorContainer=function(){var e=this;var t=e.$valueContainer;var n=e.$editorContainer;var a=e.txt.$txt;var i,r;if(t===a){i=e.$prev;r=e.$parent;if(i&&i.length){i.after(n)}else{r.prepend(n)}}else{t.after(n);t.hide()}}});e(function(e,t){e.fn.eventMenus=function(){var e=this.menus;t.each(e,function(e,t){t.bindEvent()})}});e(function(e,t){e.fn.eventMenuContainer=function(){}});e(function(e,t){e.fn.eventTxt=function(){var e=this.txt;e.saveSelectionEvent();e.updateValueEvent();e.updateMenuStyleEvent()}});e(function(r,e){r.plugin(function(){var e=this;var t=e.config.uploadImgFns;t.onload||(t.onload=function(t,e){r.log("上传结束，返回结果为 "+t);var n=this;var a=n.uploadImgOriginalName||"";var i;if(t.indexOf("error|")===0){r.warn("上传失败："+t.split("|")[1]);alert(t.split("|")[1])}else{r.log("上传成功，即将插入编辑区域，结果为："+t);i=document.createElement("img");i.onload=function(){var e='<img src="'+t+'" alt="'+a+'" style="max-width:100%;"/>';n.command(null,"insertHtml",e);r.log("已插入图片，地址 "+t);i=null};i.onerror=function(){r.error("使用返回的结果获取图片，发生错误。请确认以下结果是否正确："+t);i=null};i.src=t}});t.ontimeout||(t.ontimeout=function(e){r.error("上传图片超时");alert("上传图片超时")});t.onerror||(t.onerror=function(e){r.error("上传上图片发生错误");alert("上传上图片发生错误")})})});e(function(S,M){if(!window.FileReader||!window.FormData){return}S.plugin(function(){var g=this;var e=g.config;var w=e.uploadImgUrl;var x=e.uploadTimeout;var t=e.uploadImgFns;var y=t.onload;var b=t.ontimeout;var E=t.onerror;if(!w){return}function k(e,t){var n=window.atob(e.split(",")[1]);var a=new ArrayBuffer(n.length);var i=new Uint8Array(a);var r;for(r=0;r<n.length;r++){i[r]=n.charCodeAt(r)}return new Blob([a],{type:t})}function C(t,n){var a=document.createElement("img");a.onload=function(){var e='<img src="'+t+'" style="max-width:100%;"/>';g.command(n,"insertHtml",e);S.log("已插入图片，地址 "+t);a=null};a.onerror=function(){S.error("使用返回的结果获取图片，发生错误。请确认以下结果是否正确："+t);a=null};a.src=t}function $(e){if(e.lengthComputable){var t=e.loaded/e.total;g.showUploadProgress(t*100)}}g.xhrUploadImg=function(e){var t=e.event;var n=e.filename||"";var a=e.base64;var i=e.fileType||"image/png";var r=e.name||"wangEditor_upload_file";var o=e.loadfn||y;var l=e.errorfn||E;var c=e.timeoutfn||b;var s=g.config.uploadParams||{};var u=g.config.uploadHeaders||{};var f="png";if(n.indexOf(".")>0){f=n.slice(n.lastIndexOf(".")-n.length+1)}else if(i.indexOf("/")>0&&i.split("/")[1]){f=i.split("/")[1]}if(S.isOnWebsite){S.log("预览模拟上传");C(a,t);return}var d=new XMLHttpRequest;var v;var m;var p=new FormData;function h(){if(v){clearTimeout(v)}if(d&&d.abort){d.abort()}t.preventDefault();c&&c.call(g,d);g.hideUploadProgress()}d.onload=function(){if(v){clearTimeout(v)}g.uploadImgOriginalName=n;if(n.indexOf(".")>0){g.uploadImgOriginalName=n.split(".")[0]}o&&o.call(g,d.responseText,d);g.hideUploadProgress()};d.onerror=function(){if(v){clearTimeout(v)}t.preventDefault();l&&l.call(g,d);g.hideUploadProgress()};d.upload.onprogress=$;p.append(r,k(a,i),n);M.each(s,function(e,t){p.append(e,t)});d.open("POST",g.config.uploadImgUrl,true);M.each(u,function(e,t){d.setRequestHeader(e,t)});d.withCredentials=g.config.withCredentials||true;d.send(p);v=setTimeout(h,x);S.log("开始上传...并开始超时计算")}})});e(function(e,u){e.plugin(function(){var e=this;var t=e.menuContainer;var n=t.height();var a=e.$editorContainer;var i=a.width();var r=u('<div class="wangEditor-upload-progress"></div>');var o=false;function l(){if(o){return}o=true;r.css({top:n+"px"});a.append(r)}e.showUploadProgress=function(e){if(c){clearTimeout(c)}l();r.show();r.width(e*i/100)};var c;function s(){r.hide();c=null}e.hideUploadProgress=function(e){if(c){clearTimeout(c)}e=e||750;c=setTimeout(s,e)}})});e(function(c,s){c.plugin(function(){var e=this;var t=e.config;var n=t.uploadImgUrl;var a=t.uploadTimeout;var i;if(!n){return}var r=e.$uploadContent;if(!r){return}var o=s('<div class="upload-icon-container"><i class="wangeditor-menu-img-upload"></i></div>');r.append(o);var l=new c.UploadFile({editor:e,uploadUrl:n,timeout:a,fileAccept:"image/jpg,image/jpeg,image/png,image/gif,image/bmp"});o.click(function(e){i=e;l.selectFiles()})})});e(function(d,l){if(!window.FileReader||!window.FormData){return}var e=function(e){this.editor=e.editor;this.uploadUrl=e.uploadUrl;this.timeout=e.timeout;this.fileAccept=e.fileAccept;this.multiple=true};e.fn=e.prototype;e.fn.clear=function(){this.$input.val("");d.log("input value 已清空")};e.fn.render=function(){var t=this;if(t._hasRender){return}d.log("渲染dom");var e=t.fileAccept;var n=e?'accept="'+e+'"':"";var a=t.multiple;var i=a?'multiple="multiple"':"";var r=l('<input type="file" '+n+" "+i+"/>");var o=l('<div style="display:none;"></div>');o.append(r);d.$body.append(o);r.on("change",function(e){t.selected(e,r.get(0))});t.$input=r;t._hasRender=true};e.fn.selectFiles=function(){var e=this;d.log("使用 html5 方式上传");e.render();d.log("选择文件");e.$input.click()};e.fn.selected=function(e,t){var n=this;var a=t.files||[];if(a.length===0){return}d.log("选中 "+a.length+" 个文件");l.each(a,function(e,t){n.upload(t)})};e.fn.upload=function(e){var t=this;var n=t.editor;var a=e.name||"";var i=e.type||"";var r=n.config.uploadImgFns;var o=n.config.uploadImgFileName||"wangEditorH5File";var l=r.onload;var c=r.ontimeout;var s=r.onerror;var u=new FileReader;if(!l||!c||!s){d.error("请为编辑器配置上传图片的 onload ontimeout onerror 回调事件");return}d.log("开始执行 "+a+" 文件的上传");function f(){t.clear()}u.onload=function(e){d.log("已读取"+a+"文件");var t=e.target.result||this.result;n.xhrUploadImg({event:e,filename:a,base64:t,fileType:i,name:o,loadfn:function(e,t){f();var n=this;l.call(n,e,t)},errorfn:function(e){f();if(d.isOnWebsite){alert("wangEditor官网暂时没有服务端，因此报错。实际项目中不会发生")}var t=this;s.call(t,e)},timeoutfn:function(e){f();if(d.isOnWebsite){alert("wangEditor官网暂时没有服务端，因此超时。实际项目中不会发生")}var t=this;c(t,e)}})};u.readAsDataURL(e)};d.UploadFile=e});e(function(m,p){if(window.FileReader&&window.FormData){return}var e=function(e){this.editor=e.editor;this.uploadUrl=e.uploadUrl;this.timeout=e.timeout;this.fileAccept=e.fileAccept;this.multiple=false};e.fn=e.prototype;e.fn.clear=function(){this.$input.val("");m.log("input value 已清空")};e.fn.hideModal=function(){this.modal.hide()};e.fn.render=function(){var e=this;var t=e.editor;var n=t.config.uploadImgFileName||"wangEditorFormFile";if(e._hasRender){return}var a=e.uploadUrl;m.log("渲染dom");var i="iframe"+m.random();var r=p('<iframe name="'+i+'" id="'+i+'" frameborder="0" width="0" height="0"></iframe>');var o=e.multiple;var l=o?'multiple="multiple"':"";var c=p("<p>选择图片并上传</p>");var s=p('<input type="file" '+l+' name="'+n+'"/>');var u=p('<input type="submit" value="上传"/>');var f=p('<form enctype="multipart/form-data" method="post" action="'+a+'" target="'+i+'"></form>');var d=p('<div style="margin:10px 20px;"></div>');f.append(c).append(s).append(u);p.each(t.config.uploadParams,function(e,t){f.append(p('<input type="hidden" name="'+e+'" value="'+t+'"/>'))});d.append(f);d.append(r);e.$input=s;e.$iframe=r;var v=new m.Modal(t,void 0,{$content:d});e.modal=v;e._hasRender=true};e.fn.bindLoadEvent=function(){var a=this;if(a._hasBindLoad){return}var i=a.editor;var e=a.$iframe;var t=e.get(0);var r=t.contentWindow;var o=i.config.uploadImgFns.onload;function n(){var e=p.trim(r.document.body.innerHTML);if(!e){return}var t=a.$input.val();var n=t;if(t.lastIndexOf("\\")>=0){n=t.slice(t.lastIndexOf("\\")+1);if(n.indexOf(".")>0){n=n.split(".")[0]}}i.uploadImgOriginalName=n;o.call(i,e);a.clear();a.hideModal()}if(t.attachEvent){t.attachEvent("onload",n)}else{t.onload=n}a._hasBindLoad=true};e.fn.show=function(){var e=this;var t=e.modal;function n(){t.show();e.bindLoadEvent()}setTimeout(n)};e.fn.selectFiles=function(){var e=this;m.log("使用 form 方式上传");e.render();e.clear();e.show()};m.UploadFile=e});e(function(u,f){u.plugin(function(){var o=this;var e=o.txt;var i=e.$txt;var t=o.config;var n=t.uploadImgUrl;var l=t.uploadImgFileName||"wangEditorPasteFile";var c;var s;if(!n){return}function r(){var r=/^data:(image\/\w+);base64/;var e=i.find("img");u.log("粘贴后，检查到编辑器有"+e.length+"个图片。开始遍历图片，试图找到刚刚粘贴过来的图片");f.each(e,function(){var e=this;var t=f(e);var n;var a=t.attr("src");var i;s.each(function(){if(e===this){n=true;return false}});if(n){return}u.log("找到一个粘贴过来的图片");if(r.test(a)){u.log("src 是 base64 格式，可以上传");i=a.match(r)[1];o.xhrUploadImg({event:c,base64:a,fileType:i,name:l})}else{u.log("src 为 "+a+" ，不是 base64 格式，暂时不支持上传")}t.remove()});u.log("遍历结束")}i.on("paste",function(e){c=e;var t=c.clipboardData||c.originalEvent.clipboardData;var n;var a;if(t==null){n=window.clipboardData&&window.clipboardData.getData("text")}else{n=t.getData("text/plain")||t.getData("text/html")}if(n){return}a=t&&t.items;if(a){u.log("通过 data.items 得到了数据");f.each(a,function(e,t){var n=t.type||"";if(n.indexOf("image")<0){return}var a=t.getAsFile();var i=new FileReader;u.log("得到一个粘贴图片");i.onload=function(e){u.log("读取到粘贴的图片");var t=e.target.result||this.result;o.xhrUploadImg({event:c,base64:t,fileType:n,name:l})};i.readAsDataURL(a)})}else{u.log("未从 data.items 得到数据，使用检测粘贴图片的方式");s=i.find("img");u.log("粘贴前，检查到编辑器有"+s.length+"个图片");setTimeout(r,0)}})})});e(function(c,i){c.plugin(function(){var o=this;var e=o.txt;var t=e.$txt;var n=o.config;var a=n.uploadImgUrl;var l=n.uploadImgFileName||"wangEditorDragFile";if(!a){return}c.$document.on("dragleave drop dragenter dragover",function(e){e.preventDefault()});t.on("drop",function(r){r.preventDefault();var e=r.originalEvent;var t=e.dataTransfer&&e.dataTransfer.files;if(!t||!t.length){return}i.each(t,function(e,t){var n=t.type;var a=t.name;if(n.indexOf("image/")<0){return}c.log("得到图片 "+a);var i=new FileReader;i.onload=function(e){c.log("读取到图片 "+a);var t=e.target.result||this.result;o.xhrUploadImg({event:r,base64:t,fileType:n,name:l})};i.readAsDataURL(t)})})})});e(function(h,g){h.plugin(function(){var f=this;var e=f.txt;var i=e.$txt;var r="";var d=f.useMaxHeight?i.parent():i;var v;var t=false;var m=g('<div class="txt-toolbar"></div>');var p=g('<div class="tip-triangle"></div>');var n=g('<a href="#"><i class="wangeditor-menu-img-trash-o"></i></a>');var o=g('<a href="#"><i class="wangeditor-menu-img-search-minus"></i></a>');var l=g('<a href="#"><i class="wangeditor-menu-img-search-plus"></i></a>');function a(){if(t){return}c();m.append(p).append(n).append(o).append(l);f.$editorContainer.append(m);t=true}function c(){var a;function t(e,t){r=i.html();var n=function(){if(t){t()}if(r!==i.html()){i.change()}};if(a){f.customCommand(e,a,n)}}n.click(function(e){a=function(){v.remove()};t(e,function(){setTimeout(u,100)})});l.click(function(e){a=function(){v.css({width:"100%"})};t(e,function(){setTimeout(s)})});o.click(function(e){a=function(){v.css({width:"auto"})};t(e,function(){setTimeout(s)})})}function s(){if(f._disabled){return}if(v==null){return}v.addClass("clicked");var e=v.position();var t=e.top;var n=e.left;var a=v.outerHeight();var i=v.outerWidth();var r=t+a;var o=n;var l=0;var c=d.position().top;var s=d.outerHeight();if(r>c+s){r=c+s}m.show();var u=m.outerWidth();l=i/2-u/2;m.css({top:r+5,left:o,"margin-left":l});if(l<0){m.css("margin-left","0");p.hide()}else{p.show()}}function u(){if(v==null){return}v.removeClass("clicked");v=null;m.hide()}d.on("click","table",function(e){var t=g(e.currentTarget);a();if(v&&v.get(0)===t.get(0)){setTimeout(u,100);return}v=t;s();e.preventDefault();e.stopPropagation()}).on("click keydown scroll",function(e){setTimeout(u,100)});h.$body.on("click keydown scroll",function(e){setTimeout(u,100)})})});e(function(O,L){if(O.userAgent.indexOf("MSIE 8")>0){return}O.plugin(function(){var f=this;var e=f.config.lang;var t=f.txt;var l=t.$txt;var c="";var d=f.useMaxHeight?l.parent():l;var n=f.$editorContainer;var v;var s="";var a=false;var m=L('<div class="img-drag-point"></div>');var p=L('<div class="txt-toolbar"></div>');var h=L('<div class="tip-triangle"></div>');var i=L("<div></div>");var r=L('<a href="#"><i class="wangeditor-menu-img-trash-o"></i></a>');var o=L('<a href="#"><i class="wangeditor-menu-img-search-minus"></i></a>');var u=L('<a href="#"><i class="wangeditor-menu-img-search-plus"></i></a>');var g=L('<a href="#"><i class="wangeditor-menu-img-align-left"></i></a>');var w=L('<a href="#"><i class="wangeditor-menu-img-align-center"></i></a>');var x=L('<a href="#"><i class="wangeditor-menu-img-align-right"></i></a>');var y=L('<a href="#"><i class="wangeditor-menu-img-link"></i></a>');var b=L('<a href="#"><i class="wangeditor-menu-img-unlink"></i></a>');var E=L('<div style="display:none;"></div>');var k=L('<input type="text" style="height:26px; margin-left:10px; width:200px;"/>');var C=L('<button class="right">'+e.submit+"</button>");var $=L('<button class="right gray">'+e.cancel+"</button>");var S=false;function M(e,t){if(!v){return}var n;var a=function(){if(t!=null){s=t}if(c!==l.html()){l.change()}};var i;var r=false;var o=v.parent();if(o.get(0).nodeName.toLowerCase()==="a"){i=o;r=true}else{i=L('<a target="_blank"></a>')}if(t==null){return i.attr("href")||""}else if(t===""){if(r){n=function(){v.unwrap()}}}else{if(t===s){return}n=function(){i.attr("href",t);if(!r){v.wrap(i)}}}if(n){c=l.html();f.customCommand(e,n,a)}}function T(){if(a){return}N();R();i.append(r).append(o).append(u).append(g).append(w).append(x).append(y).append(b);E.append(k).append($).append(C);p.append(h).append(i).append(E);f.$editorContainer.append(p).append(m);a=true}function N(){var a;function t(e,t){var n;c=l.html();n=function(){if(t){t()}if(c!==l.html()){l.change()}};if(a){f.customCommand(e,a,n)}}r.click(function(e){M(e,"");a=function(){v.remove()};t(e,function(){setTimeout(P,100)})});u.click(function(e){a=function(){var e=v.get(0);var t=e.width;var n=e.height;t=t*1.1;n=n*1.1;v.css({width:t+"px",height:n+"px"})};t(e,function(){setTimeout(D)})});o.click(function(e){a=function(){var e=v.get(0);var t=e.width;var n=e.height;t=t*.9;n=n*.9;v.css({width:t+"px",height:n+"px"})};t(e,function(){setTimeout(D)})});g.click(function(e){a=function(){v.parents("p").css({"text-align":"left"}).attr("align","left")};t(e,function(){setTimeout(P,100)})});x.click(function(e){a=function(){v.parents("p").css({"text-align":"right"}).attr("align","right")};t(e,function(){setTimeout(P,100)})});w.click(function(e){a=function(){v.parents("p").css({"text-align":"center"}).attr("align","center")};t(e,function(){setTimeout(P,100)})});y.click(function(e){e.preventDefault();s=M(e);k.val(s);i.hide();E.show()});C.click(function(e){e.preventDefault();var t=L.trim(k.val());if(t){M(e,t)}setTimeout(P)});$.click(function(e){e.preventDefault();k.val(s);i.show();E.hide()});b.click(function(e){e.preventDefault();M(e,"");setTimeout(P)})}function R(){var l,c;var s,u;var f,d;function t(e){var t,n;t=e.pageX-l;n=e.pageY-c;var a=s+t;var i=u+n;m.css({"margin-left":a,"margin-top":i});var r=f+t;var o=d+n;v&&v.css({width:r,height:o})}m.on("mousedown",function(e){if(!v){return}l=e.pageX;c=e.pageY;s=parseFloat(m.css("margin-left"),10);u=parseFloat(m.css("margin-top"),10);f=v.width();d=v.height();p.hide();O.$document.on("mousemove._dragResizeImg",t);O.$document.on("mouseup._dragResizeImg",function(e){O.$document.off("mousemove._dragResizeImg");O.$document.off("mouseup._dragResizeImg");P();m.css({"margin-left":s,"margin-top":u});S=false});S=true})}function D(){if(f._disabled){return}if(v==null){return}v.addClass("clicked");var e=v.position();var t=e.top;var n=e.left;var a=v.outerHeight();var i=v.outerWidth();m.css({top:t+a,left:n+i});var r=t+a;var o=n;var l=0;var c=d.position().top;var s=d.outerHeight();if(r>c+s){r=c+s}else{m.show()}p.show();var u=p.outerWidth();l=i/2-u/2;p.css({top:r+5,left:o,"margin-left":l});if(l<0){p.css("margin-left","0");h.hide()}else{h.show()}f.disableMenusExcept()}function P(){if(v==null){return}v.removeClass("clicked");v=null;p.hide();m.hide();f.enableMenusExcept()}function I(a){var i=false;if(!f.emotionUrls){return i}L.each(f.emotionUrls,function(e,t){var n=false;if(a===t){i=true;n=true}if(n){return false}});return i}d.on("mousedown","img",function(e){e.preventDefault()}).on("click","img",function(e){var t=L(e.currentTarget);var n=t.attr("src");if(!n||I(n)){return}T();if(v&&v.get(0)===t.get(0)){setTimeout(P,100);return}v=t;D();i.show();E.hide();e.preventDefault();e.stopPropagation()}).on("click keydown scroll",function(e){if(!S){setTimeout(P,100)}})})});e(function(e,g){e.plugin(function(){var l=this;var e=l.config.lang;var t=l.txt.$txt;var c;var s=g('<div class="txt-toolbar"></div>');var n=g('<div class="tip-triangle"></div>');var a=g('<a href="#" target="_blank"><i class="wangeditor-menu-img-link"></i> '+e.openLink+"</a>");var i;var r=false;var o,u;var f,d;function v(){if(i){return}s.append(n).append(a);l.$editorContainer.append(s);i=true}function m(){if(!c){return}var e=c.position();var t=e.left;var n=e.top;var a=c.height();var i=n+a+5;var r=l.menuContainer.height();var o=l.txt.$txt.outerHeight();if(i>r+o){i=r+o+5}s.css({top:i,left:t})}function p(){if(r){return}if(!c){return}v();s.show();var e=c.attr("href");a.attr("href",e);m();r=true}function h(){if(!r){return}if(!c){return}s.hide();r=false}t.on("mouseenter","a",function(a){if(o){clearTimeout(o)}o=setTimeout(function(){var e=a.currentTarget;var t=g(e);c=t;var n=t.children("img");if(n.length){n.click(function(e){h()});if(n.hasClass("clicked")){return}}p()},500)}).on("mouseleave","a",function(e){if(u){clearTimeout(u)}u=setTimeout(h,500)}).on("click keydown scroll",function(e){setTimeout(h,100)});s.on("mouseenter",function(e){if(u){clearTimeout(u)}}).on("mouseleave",function(e){if(f){clearTimeout(f)}f=setTimeout(h,500)})})});e(function(v,e){v.plugin(function(){var n=this;var a=n.config.menuFixed;if(a===false||typeof a!=="number"){return}var i=parseFloat(v.$body.css("margin-top"),10);if(isNaN(i)){i=0}var r=n.$editorContainer;var o=r.offset().top;var l=r.outerHeight();var c=n.menuContainer.$menuContainer;var s=c.css("position");var u=c.css("top");var f=c.offset().top;var d=c.outerHeight();var e=n.txt.$txt;v.$window.scroll(function(){if(n.isFullScreen){return}var e=v.$window.scrollTop();var t=c.width();if(f===0){f=c.offset().top;o=r.offset().top;l=r.outerHeight();d=c.outerHeight()}if(e>=f&&e+a+d+30<o+l){c.css({position:"fixed",top:a});c.width(t);v.$body.css({"margin-top":i+d});if(!n._isMenufixed){n._isMenufixed=true}}else{c.css({position:s,top:u});c.css("width","100%");v.$body.css({"margin-top":i});if(n._isMenufixed){n._isMenufixed=false}}})})});e(function(a,o){a.createMenu(function(e){var t="indent";if(!e(t)){return}var r=this;var n=new a.Menu({editor:r,id:t,title:"缩进",$domNormal:o('<a href="#" tabindex="-1"><i class="wangeditor-menu-img-indent-left"></i></a>'),$domSelected:o('<a href="#" tabindex="-1" class="selected"><i class="wangeditor-menu-img-indent-left"></i></a>')});n.clickEvent=function(e){var t=r.getRangeElem();var n=r.getSelfOrParentByName(t,"p");var a;if(!n){return e.preventDefault()}a=o(n);function i(){a.css("text-indent","2em")}r.customCommand(e,i)};n.clickEventSelected=function(e){var t=r.getRangeElem();var n=r.getSelfOrParentByName(t,"p");var a;if(!n){return e.preventDefault()}a=o(n);function i(){a.css("text-indent","0")}r.customCommand(e,i)};n.updateSelectedEvent=function(){var e=r.getRangeElem();var t=r.getSelfOrParentByName(e,"p");var n;var a;if(!t){return false}n=o(t);a=n.css("text-indent");if(!a||a==="0px"){return false}return true};r.menus[t]=n})});e(function(o,l){o.createMenu(function(e){var t="lineheight";if(!e(t)){return}var a=this;a.commandHooks.lineHeight=function(e){var t=a.getRangeElem();var n=a.getSelfOrParentByName(t,"p,h1,h2,h3,h4,h5,pre");if(!n){return}l(n).css("line-height",e+"")};var n=new o.Menu({editor:a,id:t,title:"行高",commandName:"lineHeight",$domNormal:l('<a href="#" tabindex="-1"><i class="wangeditor-menu-img-arrows-v"></i></a>'),$domSelected:l('<a href="#" tabindex="-1" class="selected"><i class="wangeditor-menu-img-arrows-v"></i></a>')});var i={"1.0":"1.0倍",1.5:"1.5倍",1.8:"1.8倍","2.0":"2.0倍",2.5:"2.5倍","3.0":"3.0倍"};var r='<span style="line-height:{#commandValue}">{#title}</span>';n.dropList=new o.DropList(a,n,{data:i,tpl:r});a.menus[t]=n})});e(function(o,l){o.plugin(function(){var e=this;var t=e.config.customUpload;if(!t){return}else if(e.config.uploadImgUrl){alert("自定义上传无效，详看浏览器日志console.log");o.error("已经配置了 uploadImgUrl ，就不能再配置 customUpload ，两者冲突。将导致自定义上传无效。");return}var n=e.$uploadContent;if(!n){o.error("自定义上传，无法获取 editor.$uploadContent")}var a=l('<div class="upload-icon-container"><i class="wangeditor-menu-img-upload"></i></div>');n.append(a);var i="upload"+o.random();var r="upload"+o.random();a.attr("id",i);n.attr("id",r);e.customUploadBtnId=i;e.customUploadContainerId=r})});e(function(e,t){e.info("本页面富文本编辑器由 wangEditor 提供 https://wangeditor.github.io/ ")});return window.wangEditor});